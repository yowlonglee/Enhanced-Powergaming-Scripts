// **********************************************************************
// *           Segment Name: mocore.baf
// **********************************************************************
// *
// * Description:
// * This script is designed for all classes: Fighter, Mage, Thief, Cleric, Druid, Ranger, Paladin, Shaman, and 
// * any combination of multiclass/dualclass to include kits. This script will constantly 
// * Turn Undead when the V key is pressed and will cast pre-buffing spells when the B key 
// * is pressed. If the character is able, the script will constantly be detecting traps.

IF
  Global("BDAI_ATTACK_MODE","LOCALS",0)
THEN
  RESPONSE #100
    SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
END

/*
IF 
  OR(2)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
  !GlobalTimerNotExpired("MO_SpellCastTimer","LOCALS")
  EEex_LuaTrigger("return MO_AmCastingCooldown()")
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCastTimer","LOCALS",2)
    Continue()
END
*/
/*
IF 
  OR(2)
    !EEex_LuaTrigger("return MO_AmCastingCooldown()")
    CheckStatGT(Myself,0,AURACLEANSING)
  OR(2)
    !GlobalTimerNotExpired("MO_SpellCastTimer","LOCALS")
    CheckStatGT(Myself,0,AURACLEANSING)
  EEex_LuaTrigger("return MO_AmCastingCooldown()")
  Global("MO_SpellCast","LOCALS",0)
THEN
  RESPONSE #100
    SetGlobal("MO_SpellCast","LOCALS",1)
    SetGlobalTimer("MO_SpellCastTimer","LOCALS",6)
    Continue()
END

IF
  Global("MO_SpellCast","LOCALS",1)
  !Global("BDAI_SKILL_MODE","LOCALS",3)
THEN
  RESPONSE #100
    //SetGlobalTimer("MO_SpellCastTimer","LOCALS",6)
    SetGlobal("MO_SpellCast","LOCALS",0)
    Continue()
END

IF
  Global("MO_SpellCast","LOCALS",1)
  Global("BDAI_SKILL_MODE","LOCALS",3)
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCastTimer","LOCALS",6)
    SetGlobal("MO_SpellCast","LOCALS",0)
    Continue()
END
*/

IF 
  OR(2)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
  !CheckSpellState(Myself,NEED_IMPROVED_HASTE)
  !HaveSpell(WIZARD_IMPROVED_HASTE)
  !HaveSpell(WARRIOR_GREATER_WHIRLWIND)
  OR(2)
    GlobalGT("MO_UsedCheetah","GLOBAL",0)
    !HasItemEquiped("AMUL26",Myself)  // Amulet of Cheetah Speed
  OR(2)
    GlobalGT("MO_UsedRingGaxx","GLOBAL",2)
    !HasItemEquiped("RING39",Myself)  // Ring of Gaxx
  OR(2)
    GlobalGT("MO_UsedBlindingSpeed","GLOBAL",0)
    !HasItemEquiped("BRAC16",Myself)  // Bracers of Blinding Strike
  //CheckStatGT(Myself,2,NUMBEROFATTACKS)
  !Class(Myself,MONK)
THEN 
  RESPONSE #100
    ApplySpellRES("MONHST1",Myself)
END

IF 
  OR(2)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
  CheckSpellState(Myself,NEED_IMPROVED_HASTE)
  OR(2)
    HaveSpell(WIZARD_IMPROVED_HASTE)
    HaveSpell(WARRIOR_GREATER_WHIRLWIND)
  //CheckStatGT(Myself,2,NUMBEROFATTACKS)
  !Class(Myself,MONK)
THEN 
  RESPONSE #100
    ApplySpellRES("MONHST2",Myself)
END

IF 
  OR(2)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
  CheckSpellState(Myself,NEED_IMPROVED_HASTE)
  HasItemEquiped("AMUL26",Myself)  // Amulet of Cheetah Speed
  GlobalLT("MO_UsedCheetah","GLOBAL",1)
  //CheckStatGT(Myself,2,NUMBEROFATTACKS)
  !Class(Myself,MONK)
THEN 
  RESPONSE #100
    ApplySpellRES("MONHST2",Myself)
END

IF 
  OR(2)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
  CheckSpellState(Myself,NEED_IMPROVED_HASTE)
  HasItemEquiped("RING39",Myself)  // Ring of Gaxx
  GlobalLT("MO_UsedRingGaxx","GLOBAL",3)
  //CheckStatGT(Myself,2,NUMBEROFATTACKS)
  !Class(Myself,MONK)
THEN 
  RESPONSE #100
    ApplySpellRES("MONHST2",Myself)
END

IF 
  OR(2)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
  CheckSpellState(Myself,NEED_IMPROVED_HASTE)
  HasItemEquiped("BRAC16",Myself)  // Bracers of Blinding Strike
  GlobalLT("MO_UsedBlindingSpeed","GLOBAL",1)
  //CheckStatGT(Myself,2,NUMBEROFATTACKS)
  !Class(Myself,MONK)
THEN 
  RESPONSE #100
    ApplySpellRES("MONHST2",Myself)
END

// Singing Check 2

IF
  Global("BDAI_SKILL_MODE","LOCALS",0)
  OR(3)
    Class(Myself,THIEF_ALL)
    Class(Myself,MONK)
    Class(Myself,SHAMAN)
  HotKey(hot_key_SwapSkills)
THEN
  RESPONSE #100
    SetGlobal("BDAI_SKILL_MODE","LOCALS",1)
    DisplayStringHead(Myself,@5018)
END

IF
  OR(2)
    Global("BDAI_SKILL_MODE","LOCALS",0)
    Global("BDAI_SKILL_MODE","LOCALS",1)
  OR(3)
    Class(Myself,THIEF_ALL)
    Class(Myself,RANGER_ALL)
    Class(Myself,MONK)
  HotKey(hot_key_SwapSkills)
THEN
  RESPONSE #100
    SetGlobal("BDAI_SKILL_MODE","LOCALS",2)
    DisplayStringHead(Myself,@5030)
END

IF
  OR(3)
    Global("BDAI_SKILL_MODE","LOCALS",0)
    Global("BDAI_SKILL_MODE","LOCALS",1)
    Global("BDAI_SKILL_MODE","LOCALS",2)
  Class(Myself,BARD_ALL)
  HotKey(hot_key_SwapSkills)
THEN
  RESPONSE #100
    SetGlobal("BDAI_SKILL_MODE","LOCALS",3)
    DisplayStringHead(Myself,@5029)
END

IF
  !Global("BDAI_SKILL_MODE","LOCALS",4)
  OR(2)
    Class(Myself,CLERIC_ALL)
    Class(Myself,PALADIN_ALL)
  !Kit(Myself,INQUISITOR)
  HotKey(hot_key_SwapSkills)
THEN
  RESPONSE #100
    SetGlobal("BDAI_SKILL_MODE","LOCALS",4)
    DisplayStringHead(Myself,@5000)
END

IF
  !Global("BDAI_SKILL_MODE","LOCALS",0)
  HotKey(hot_key_SwapSkills)
THEN
  RESPONSE #100
    SetGlobal("BDAI_SKILL_MODE","LOCALS",0)
    DisplayStringHead(Myself,@5028)
END

IF
  HotKey(hot_key_WeaponSwap)
  !HasItem("melfmet",Myself)  // Melf's Minute Meteor
  !CheckSpellState(Myself,BLACK_BLADE)  // Black Blade of Disaster
  !IsWeaponRanged(Myself)
  CanEquipRanged()
THEN
  RESPONSE #100
    EquipRanged()
    DisplayStringHead(Myself,@5025)  
END

IF
  HotKey(hot_key_WeaponSwap)
  !HasItem("melfmet",Myself)  // Melf's Minute Meteor
  !CheckSpellState(Myself,BLACK_BLADE)  // Black Blade of Disaster
  IsWeaponRanged(Myself)
THEN
  RESPONSE #100
    EquipMostDamagingMelee()
    DisplayStringHead(Myself,@5024)
END

IF
  HotKey(hot_key_SoloBuff)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
THEN
  RESPONSE #100
    SetGlobal("BDAI_ATTACK_MODE","LOCALS",1)
    DisplayStringHead(Myself,@5027)
END

IF
  HotKey(hot_key_SoloBuff)
  Global("BDAI_ATTACK_MODE","LOCALS",1)
THEN
  RESPONSE #100
    SetGlobal("BDAI_ATTACK_MODE","LOCALS",2)
    DisplayStringHead(Myself,@5026)
END

IF
  !GlobalTimerNotExpired("MO_HealCast","GLOBAL")
  Global("MO_CastingHeal","GLOBAL",1)
THEN
  RESPONSE #100
    SetGlobal("MO_CastingHeal","GLOBAL",0)
END

IF
  !GlobalTimerNotExpired("MO_DetectEnemyIllusionTimer","LOCALS")
  Global("MO_DetectEnemyIllusion","GLOBAL",1)
  Global("MO_MyDetectEnemyIllusion","LOCALS",1)
THEN
  RESPONSE #100
    SetGlobal("MO_DetectEnemyIllusion","GLOBAL",0)
    SetGlobal("MO_MyDetectEnemyIllusion","LOCALS",0)
END

IF
  OR(2)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
  Global("MO_SelfRaiseDead","LOCALS",1)
  Global("MO_PartyRaiseDead","GLOBAL",1)
THEN
  RESPONSE #100
    SetGlobal("MO_SelfRaiseDead","LOCALS",0)
    SetGlobal("MO_PartyRaiseDead","GLOBAL",0)
END

IF
  OR(3)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
    !GlobalTimerNotExpired("MO_FearCastTimer","GLOBAL")
  Global("MO_SelfRemoveFear","LOCALS",1)
  Global("MO_PartyRemoveFear","GLOBAL",1)
THEN
  RESPONSE #100
    SetGlobal("MO_SelfRemoveFear","LOCALS",0)
    SetGlobal("MO_PartyRemoveFear","GLOBAL",0)
END

IF
  OR(3)
    ActionListEmpty()
    EEex_LuaTrigger("return AmAttacking()")
    !GlobalTimerNotExpired("MO_ParalysisCastTimer","GLOBAL")
  Global("MO_SelfRemoveParalysis","LOCALS",1)
  Global("MO_PartyRemoveParalysis","GLOBAL",1)
THEN
  RESPONSE #100
    SetGlobal("MO_SelfRemoveParalysis","LOCALS",0)
    SetGlobal("MO_PartyRemoveParalysis","GLOBAL",0)
END

IF
  PartyRested()
THEN
  RESPONSE #100
    SetGlobalTimer("MO_SpellCastTimer","LOCALS",2)
    SetGlobal("MO_UsedIlbratha","GLOBAL",0)
    SetGlobal("MO_UsedDuplication","GLOBAL",0)
    SetGlobal("MO_UsedGargoyle","GLOBAL",0)
    SetGlobal("MO_UsedCheetah","GLOBAL",0)
    SetGlobal("MO_UsedDevout","GLOBAL",0)
    SetGlobal("MO_UsedFortitude","GLOBAL",0)
    SetGlobal("MO_UsedSpellTurning","GLOBAL",0)
    SetGlobal("MO_UsedClkOfStars","GLOBAL",0)
    SetGlobal("MO_UsedCowlOfStars","GLOBAL",0)
    SetGlobal("MO_UsedBltMnrInv","GLOBAL",0)
    SetGlobal("MO_UsedClkDrkMN","GLOBAL",0)
    SetGlobal("MO_UsedShldFyrus","GLOBAL",0)
    SetGlobal("MO_UsedMirrorAmulet0","GLOBAL",0)
    SetGlobal("MO_UsedMirrorAmulet1","GLOBAL",0)
    SetGlobal("MO_UsedDaystar","GLOBAL",0)
    SetGlobal("MO_UsedMagiStaff","GLOBAL",0)
    SetGlobal("MO_UsedRingGaxx","GLOBAL",0)
    SetGlobal("MO_UsedBlindingSpeed","GLOBAL",0)
    SetGlobal("MO_UsedGemOfSeeing","GLOBAL",0)
    SetGlobal("MO_UsedVisage","GLOBAL",0)
    SetGlobal("MO_UsedHolyCoin","GLOBAL",0)
    SetGlobal("MO_UsedRodOfVinearrows","GLOBAL",0)
    SetGlobal("MO_UsedVelvetNight","GLOBAL",0)
    SetGlobal("MO_UsedBrokenGlasses","GLOBAL",0)
    SetGlobal("MO_UsedRobeEye","GLOBAL",0)
    SetGlobal("MO_UsedRogueCowl","GLOBAL",0)
    SetGlobal("MO_UsedBarrierAmulet","GLOBAL",0)
    SetGlobal("MO_UsedMethildHarp","GLOBAL",0)
END

// Set global variables to stop party from casting the same spells
// True Sight, Protection from Evil, Remove Paralysis, Exaltation

IF
  Global("MO_TrueSightActive","LOCALS",1)
  CheckStat(Myself,0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobal("MO_TrueSightActive","LOCALS",0)
    SetGlobal("MO_PartyTrueSight","GLOBAL",0)
END

IF
  Global("MO_TrueSightActive","LOCALS",0)
  CheckStatGT(Myself,0,TRUE_SIGHT)
THEN
  RESPONSE #100
    SetGlobal("MO_TrueSightActive","LOCALS",1)
    SetGlobal("MO_PartyTrueSight","GLOBAL",1)
END

IF
  HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
  OR(2)
    Global("MO_ProtEvil","LOCALS",0)
    Global("MO_TeamProtEvil","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("MO_ProtEvil","LOCALS",1)
    SetGlobal("MO_TeamProtEvil","GLOBAL",1)
END

IF
  !HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
  Global("MO_ProtEvil","LOCALS",1)
THEN
  RESPONSE #100
    SetGlobal("MO_ProtEvil","LOCALS",0)
    SetGlobal("MO_TeamProtEvil","GLOBAL",0)
END

// Cast spells normally

IF
  Global("MO_DISABLECOWLED","LOCALS",0)
  HotKey(hot_key_CowledCheck)
  Global("BRIBEDCOWLED","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("MO_DISABLECOWLED","LOCALS",1)
    SetGlobal("MO_CastAthkatla","LOCALS",1)
    DisplayStringHead(Myself,@5020)
END

// Do not cast spells in Athkatla because we haven't pay for the licence

IF
  Global("MO_DISABLECOWLED","LOCALS",1)
  HotKey(hot_key_CowledCheck)
THEN
  RESPONSE #100
    SetGlobal("MO_DISABLECOWLED","LOCALS",0)
    SetGlobal("MO_CastAthkatla","LOCALS",0)
    DisplayStringHead(Myself,@5021)
END

IF
  OR(8)
    AreaCheck("AR0700")  // Waukeen's Promenade
    AreaCheck("AR0020")  // City Gates
    AreaCheck("AR0800")  // Graveyard
    AreaCheck("AR0400")  // Slums
    AreaCheck("AR0300")  // The Docks
    AreaCheck("AR0500")  // Bridge District
    AreaCheck("AR1000")  // Government District
    AreaCheck("AR0900")  // Temple District
  Global("BRIBEDCOWLED","GLOBAL",0)
  Global("MO_DISABLECOWLED","LOCALS",0)
  GlobalLT("CowledWarning","GLOBAL",7)
  Global("MO_CastAthkatla","LOCALS",1)
THEN
  RESPONSE #100
    SetGlobal("MO_CastAthkatla","LOCALS",0)
END

IF
  !AreaCheck("AR0700")  // Waukeen's Promenade
  !AreaCheck("AR0020")  // City Gates
  !AreaCheck("AR0800")  // Graveyard
  !AreaCheck("AR0400")  // Slums
  !AreaCheck("AR0300")  // The Docks
  !AreaCheck("AR0500")  // Bridge District
  !AreaCheck("AR1000")  // Government District
  !AreaCheck("AR0900")  // Temple District
  Global("MO_CastAthkatla","LOCALS",0)
THEN
  RESPONSE #100
    SetGlobal("MO_CastAthkatla","LOCALS",1)
END

IF
  OR(2)
    Global("BRIBEDCOWLED","GLOBAL",1)
    Global("CowledWarning","GLOBAL",7)
  Global("MO_CastAthkatla","LOCALS",0)
THEN
  RESPONSE #100
    SetGlobal("MO_CastAthkatla","LOCALS",1)
END

////////////////////////////////////////////////////
// Prebuff scripts start here
////////////////////////////////////////////////////

IF
  Global("MO_BUFF","LOCALS",0)
  HotKey(hot_key_Buffing)
THEN
  RESPONSE #100
    SetGlobal("MO_BUFF","LOCALS",1)
    SetGlobal("MO_LONG_BUFF","LOCALS",0)
    // SetGlobal("BDAI_ATTACK_MODE","LOCALS",1) to determin if this character buffs self or party
    // I need to add new strings
    DisplayStringHead(Myself,@5002)
END

IF
  Global("MO_BUFF","LOCALS",0)
  Global("MO_LONG_BUFF","LOCALS",0)
  HotKey(hot_key_LongBuffing)
THEN
  RESPONSE #100
    SetGlobal("MO_LONG_BUFF","LOCALS",1)
    DisplayStringHead(Myself,@5031)
END

IF
  Global("MO_BUFF","LOCALS",1)
  OR(2)
    HotKey(hot_key_Buffing)
    See([EVILCUTOFF])
THEN
  RESPONSE #100
    SetGlobal("MO_BUFF","LOCALS",0)
    DisplayStringHead(Myself,@5003)
END

IF
  Global("MO_LONG_BUFF","LOCALS",1)
  OR(2)
    HotKey(hot_key_LongBuffing)
    See([EVILCUTOFF])
THEN
  RESPONSE #100
    SetGlobal("MO_LONG_BUFF","LOCALS",0)
    DisplayStringHead(Myself,@5003)
END

////////////////////////////////////////////////////
// Cast First to Reduce Negative Surges
// 5e Spellcasting Prebuff Improved Chaos Shield

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_IMPROVED_CHAOS_SHIELD)  // SPWI723.SPL (Improved Chaos Shield)
  !CheckSpellState(Myself,IMPROVED_CHAOS_SHIELD)
  !CheckSpellState(Myself,CHAOS_SHIELD)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_IMPROVED_CHAOS_SHIELD)  // SPWI723.SPL (Improved Chaos Shield)
    RemoveSpell(WIZARD_IMPROVED_CHAOS_SHIELD)  // SPWI723.SPL (Improved Chaos Shield)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_CHAOS_SHIELD)  // SPWI222.SPL (Chaos Shield)
  !CheckSpellState(Myself,IMPROVED_CHAOS_SHIELD)
  !CheckSpellState(Myself,CHAOS_SHIELD)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_CHAOS_SHIELD)  // SPWI222.SPL (Chaos Shield)
    RemoveSpell(WIZARD_CHAOS_SHIELD)  // SPWI222.SPL (Chaos Shield)
END

////////////////////////////////////////////////////
// Indefinite
// 5e Spellcasting Prebuff Melf Meteor
/*
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
  !HasItem("melfmet",Myself)  // Melf's Minute Meteor
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobal("MO_HasMelfMeteors","LOCALS",1)
    ReallyForceSpell(Myself,WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
    RemoveSpell(WIZARD_MELF_METEOR)  // SPWI325.SPL (Melf's Minute Meteors)
END
*/
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  HasItemEquiped("OHRCLCK1",Myself)  // Cowl of the Stars
  !HasItem("melfmet",Myself)  // Melf's Minute Meteor
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    SetGlobal("MO_HasMelfMeteors","LOCALS",1)
    UseItem("OHRCLCK1",Myself)  // Cowl of the Stars
    IncrementGlobal("MO_UsedCowlOfStars","GLOBAL",1)
END

////////////////////////////////////////////////////
// 12 hours
// 5e Spellcasting Prebuff Stoneskin

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  CheckStatLT(Myself,1,STONESKINS)
  HaveSpell(WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
    RemoveSpell(WIZARD_STONE_SKIN)  // SPWI408.SPL (Stoneskin)
END

// 5e Spellcasting Prebuff Iron Skins

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  CheckStatLT(Myself,1,STONESKINS)
  HaveSpell(CLERIC_IRONSKIN)  // SPPR506.SPL (Iron Skins)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_IRONSKIN)  // SPPR506.SPL (Iron Skins)
    RemoveSpell(CLERIC_IRONSKIN)  // SPPR506.SPL (Iron Skins)
END

////////////////////////////////////////////////////
// 8 hours
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  GlobalLT("MO_UsedMagiStaff","GLOBAL",1)
  HasItemEquiped("STAF11",Myself)
  CheckStatLT(Myself,1,WIZARD_SPELL_TRAP)
THEN
  RESPONSE #100
    UseItemAbility("STAF11",Myself,SLOT_AMMO3,2)
    IncrementGlobal("MO_UsedMagiStaff","GLOBAL",1)
END

// Cat's Grace (1 hour/level)

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
  See(Myself)
  !CheckSpellState(LastSeenBy(Myself),CATS_GRACE)
  CheckStatLT(LastSeenBy(Myself),18,DEX)
  OR(5)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),THIEF_ALL)
    Class(LastSeenBy(Myself),BARD_ALL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
    RemoveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
  See([PC])
  !CheckSpellState(LastSeenBy(Myself),CATS_GRACE)
  CheckStatLT(LastSeenBy(Myself),18,DEX)
  OR(5)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),THIEF_ALL)
    Class(LastSeenBy(Myself),BARD_ALL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
    RemoveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
  See(SecondNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),CATS_GRACE)
  CheckStatLT(LastSeenBy(Myself),18,DEX)
  OR(5)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),THIEF_ALL)
    Class(LastSeenBy(Myself),BARD_ALL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
    RemoveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
  See(ThirdNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),CATS_GRACE)
  CheckStatLT(LastSeenBy(Myself),18,DEX)
  OR(5)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),THIEF_ALL)
    Class(LastSeenBy(Myself),BARD_ALL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
    RemoveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
  See(FourthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),CATS_GRACE)
  CheckStatLT(LastSeenBy(Myself),18,DEX)
  OR(5)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),THIEF_ALL)
    Class(LastSeenBy(Myself),BARD_ALL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
    RemoveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
  See(FifthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),CATS_GRACE)
  CheckStatLT(LastSeenBy(Myself),18,DEX)
  OR(5)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),THIEF_ALL)
    Class(LastSeenBy(Myself),BARD_ALL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
    RemoveSpell(WIZARD_CATS_GRACE)  // SPWI227.SPL (Cat's Grace)
END



////////////////////////////////////////////////////
// 1 Turn/Level
// 5e Spellcasting Prebuff IWD Mind Blank and Impervious Sanctity of Mind

// Prebuff IWD Mind Blank and Impervious Sanctity of Mind

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(CLERIC_IMPERVIOUS_SANCTITY_OF_MIND)  // SPPR735.SPL (Impervious Sanctity of Mind)
  !CheckSpellState(Myself,BARBARIAN_RAGE)
  !CheckSpellState(Myself,BERSERKER_RAGE)
  !CheckSpellState(Myself,CHAOTIC_COMMANDS)
  !CheckSpellState(Myself,MIND_BLANK)
  !CheckSpellState(Myself,POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",Myself) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",Myself) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",Myself) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",Myself) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",Myself) // Improved Nymph Cloak
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_IMPERVIOUS_SANCTITY_OF_MIND)  // SPPR735.SPL (Impervious Sanctity of Mind)
    RemoveSpell(CLERIC_IMPERVIOUS_SANCTITY_OF_MIND)  // SPPR735.SPL (Impervious Sanctity of Mind)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_MIND_BLANK)  // SPWI806.SPL (Mind Blank)
  !CheckSpellState(Myself,BARBARIAN_RAGE)
  !CheckSpellState(Myself,BERSERKER_RAGE)
  !CheckSpellState(Myself,CHAOTIC_COMMANDS)
  !CheckSpellState(Myself,MIND_BLANK)
  !CheckSpellState(Myself,POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",Myself) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",Myself) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",Myself) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",Myself) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",Myself) // Improved Nymph Cloak
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_MIND_BLANK)  // SPWI806.SPL (Mind Blank)
    RemoveSpell(WIZARD_MIND_BLANK)  // SPWI806.SPL (Mind Blank)
END

// Prebuff Potions

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,15,DEX)
  OR(17)
    HasItemEquiped("potn19",Myself)  // Potion of Agility
    CheckItemSlot(Myself,"potn19",SLOT_MISC3)
    CheckItemSlot(Myself,"potn19",SLOT_MISC4)
    CheckItemSlot(Myself,"potn19",SLOT_MISC5)
    CheckItemSlot(Myself,"potn19",SLOT_MISC6)
    CheckItemSlot(Myself,"potn19",SLOT_MISC7)
    CheckItemSlot(Myself,"potn19",SLOT_MISC8)
    CheckItemSlot(Myself,"potn19",SLOT_MISC9)
    CheckItemSlot(Myself,"potn19",SLOT_MISC10)
    CheckItemSlot(Myself,"potn19",SLOT_MISC11)
    CheckItemSlot(Myself,"potn19",SLOT_MISC12)
    CheckItemSlot(Myself,"potn19",SLOT_MISC13)
    CheckItemSlot(Myself,"potn19",SLOT_MISC14)
    CheckItemSlot(Myself,"potn19",SLOT_MISC15)
    CheckItemSlot(Myself,"potn19",SLOT_MISC16)
    CheckItemSlot(Myself,"potn19",SLOT_MISC17)
    CheckItemSlot(Myself,"potn19",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn19",Myself)  // Potion of Agility
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,15,CON)
  OR(17)
    HasItemEquiped("potn28",Myself)  // Potion of Fortitude
    CheckItemSlot(Myself,"potn28",SLOT_MISC3)
    CheckItemSlot(Myself,"potn28",SLOT_MISC4)
    CheckItemSlot(Myself,"potn28",SLOT_MISC5)
    CheckItemSlot(Myself,"potn28",SLOT_MISC6)
    CheckItemSlot(Myself,"potn28",SLOT_MISC7)
    CheckItemSlot(Myself,"potn28",SLOT_MISC8)
    CheckItemSlot(Myself,"potn28",SLOT_MISC9)
    CheckItemSlot(Myself,"potn28",SLOT_MISC10)
    CheckItemSlot(Myself,"potn28",SLOT_MISC11)
    CheckItemSlot(Myself,"potn28",SLOT_MISC12)
    CheckItemSlot(Myself,"potn28",SLOT_MISC13)
    CheckItemSlot(Myself,"potn28",SLOT_MISC14)
    CheckItemSlot(Myself,"potn28",SLOT_MISC15)
    CheckItemSlot(Myself,"potn28",SLOT_MISC16)
    CheckItemSlot(Myself,"potn28",SLOT_MISC17)
    CheckItemSlot(Myself,"potn28",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn28",Myself)  // Potion of Fortitude
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  !CheckSpellState(Myself,BUFF_ENHANCEMENT)
  OR(17)
    HasItemEquiped("potn41",Myself)  // Potion of Power
    CheckItemSlot(Myself,"potn41",SLOT_MISC3)
    CheckItemSlot(Myself,"potn41",SLOT_MISC4)
    CheckItemSlot(Myself,"potn41",SLOT_MISC5)
    CheckItemSlot(Myself,"potn41",SLOT_MISC6)
    CheckItemSlot(Myself,"potn41",SLOT_MISC7)
    CheckItemSlot(Myself,"potn41",SLOT_MISC8)
    CheckItemSlot(Myself,"potn41",SLOT_MISC9)
    CheckItemSlot(Myself,"potn41",SLOT_MISC10)
    CheckItemSlot(Myself,"potn41",SLOT_MISC11)
    CheckItemSlot(Myself,"potn41",SLOT_MISC12)
    CheckItemSlot(Myself,"potn41",SLOT_MISC13)
    CheckItemSlot(Myself,"potn41",SLOT_MISC14)
    CheckItemSlot(Myself,"potn41",SLOT_MISC15)
    CheckItemSlot(Myself,"potn41",SLOT_MISC16)
    CheckItemSlot(Myself,"potn41",SLOT_MISC17)
    CheckItemSlot(Myself,"potn41",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn41",Myself)  // Potion of Power
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  !CheckSpellState(Myself,BUFF_ENHANCEMENT)
  OR(17)
    HasItemEquiped("potn09",Myself)  // Potion of Heroism
    CheckItemSlot(Myself,"potn09",SLOT_MISC3)
    CheckItemSlot(Myself,"potn09",SLOT_MISC4)
    CheckItemSlot(Myself,"potn09",SLOT_MISC5)
    CheckItemSlot(Myself,"potn09",SLOT_MISC6)
    CheckItemSlot(Myself,"potn09",SLOT_MISC7)
    CheckItemSlot(Myself,"potn09",SLOT_MISC8)
    CheckItemSlot(Myself,"potn09",SLOT_MISC9)
    CheckItemSlot(Myself,"potn09",SLOT_MISC10)
    CheckItemSlot(Myself,"potn09",SLOT_MISC11)
    CheckItemSlot(Myself,"potn09",SLOT_MISC12)
    CheckItemSlot(Myself,"potn09",SLOT_MISC13)
    CheckItemSlot(Myself,"potn09",SLOT_MISC14)
    CheckItemSlot(Myself,"potn09",SLOT_MISC15)
    CheckItemSlot(Myself,"potn09",SLOT_MISC16)
    CheckItemSlot(Myself,"potn09",SLOT_MISC17)
    CheckItemSlot(Myself,"potn09",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn09",Myself)  // Potion of Heroism
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,70,RESISTFIRE)
  OR(17)
    HasItemEquiped("potn02",Myself)  // Potion of Fire Resistance
    CheckItemSlot(Myself,"potn02",SLOT_MISC3)
    CheckItemSlot(Myself,"potn02",SLOT_MISC4)
    CheckItemSlot(Myself,"potn02",SLOT_MISC5)
    CheckItemSlot(Myself,"potn02",SLOT_MISC6)
    CheckItemSlot(Myself,"potn02",SLOT_MISC7)
    CheckItemSlot(Myself,"potn02",SLOT_MISC8)
    CheckItemSlot(Myself,"potn02",SLOT_MISC9)
    CheckItemSlot(Myself,"potn02",SLOT_MISC10)
    CheckItemSlot(Myself,"potn02",SLOT_MISC11)
    CheckItemSlot(Myself,"potn02",SLOT_MISC12)
    CheckItemSlot(Myself,"potn02",SLOT_MISC13)
    CheckItemSlot(Myself,"potn02",SLOT_MISC14)
    CheckItemSlot(Myself,"potn02",SLOT_MISC15)
    CheckItemSlot(Myself,"potn02",SLOT_MISC16)
    CheckItemSlot(Myself,"potn02",SLOT_MISC17)
    CheckItemSlot(Myself,"potn02",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn02",Myself)  // Potion of Fire Resistance
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,70,RESISTCOLD)
  OR(17)
    HasItemEquiped("potn22",Myself)  // Potion of Cold Resistance
    CheckItemSlot(Myself,"potn22",SLOT_MISC3)
    CheckItemSlot(Myself,"potn22",SLOT_MISC4)
    CheckItemSlot(Myself,"potn22",SLOT_MISC5)
    CheckItemSlot(Myself,"potn22",SLOT_MISC6)
    CheckItemSlot(Myself,"potn22",SLOT_MISC7)
    CheckItemSlot(Myself,"potn22",SLOT_MISC8)
    CheckItemSlot(Myself,"potn22",SLOT_MISC9)
    CheckItemSlot(Myself,"potn22",SLOT_MISC10)
    CheckItemSlot(Myself,"potn22",SLOT_MISC11)
    CheckItemSlot(Myself,"potn22",SLOT_MISC12)
    CheckItemSlot(Myself,"potn22",SLOT_MISC13)
    CheckItemSlot(Myself,"potn22",SLOT_MISC14)
    CheckItemSlot(Myself,"potn22",SLOT_MISC15)
    CheckItemSlot(Myself,"potn22",SLOT_MISC16)
    CheckItemSlot(Myself,"potn22",SLOT_MISC17)
    CheckItemSlot(Myself,"potn22",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn22",Myself)  // Potion of Cold Resistance
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,70,RESISTELECTRICITY)
  OR(17)
    HasItemEquiped("potn18",Myself)  // Potion of Absorption
    CheckItemSlot(Myself,"potn18",SLOT_MISC3)
    CheckItemSlot(Myself,"potn18",SLOT_MISC4)
    CheckItemSlot(Myself,"potn18",SLOT_MISC5)
    CheckItemSlot(Myself,"potn18",SLOT_MISC6)
    CheckItemSlot(Myself,"potn18",SLOT_MISC7)
    CheckItemSlot(Myself,"potn18",SLOT_MISC8)
    CheckItemSlot(Myself,"potn18",SLOT_MISC9)
    CheckItemSlot(Myself,"potn18",SLOT_MISC10)
    CheckItemSlot(Myself,"potn18",SLOT_MISC11)
    CheckItemSlot(Myself,"potn18",SLOT_MISC12)
    CheckItemSlot(Myself,"potn18",SLOT_MISC13)
    CheckItemSlot(Myself,"potn18",SLOT_MISC14)
    CheckItemSlot(Myself,"potn18",SLOT_MISC15)
    CheckItemSlot(Myself,"potn18",SLOT_MISC16)
    CheckItemSlot(Myself,"potn18",SLOT_MISC17)
    CheckItemSlot(Myself,"potn18",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn18",Myself)  // Potion of Absorption
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,70,RESISTMAGIC)
  OR(17)
    HasItemEquiped("potn34",Myself)  // Potion of Magic Protection
    CheckItemSlot(Myself,"potn34",SLOT_MISC3)
    CheckItemSlot(Myself,"potn34",SLOT_MISC4)
    CheckItemSlot(Myself,"potn34",SLOT_MISC5)
    CheckItemSlot(Myself,"potn34",SLOT_MISC6)
    CheckItemSlot(Myself,"potn34",SLOT_MISC7)
    CheckItemSlot(Myself,"potn34",SLOT_MISC8)
    CheckItemSlot(Myself,"potn34",SLOT_MISC9)
    CheckItemSlot(Myself,"potn34",SLOT_MISC10)
    CheckItemSlot(Myself,"potn34",SLOT_MISC11)
    CheckItemSlot(Myself,"potn34",SLOT_MISC12)
    CheckItemSlot(Myself,"potn34",SLOT_MISC13)
    CheckItemSlot(Myself,"potn34",SLOT_MISC14)
    CheckItemSlot(Myself,"potn34",SLOT_MISC15)
    CheckItemSlot(Myself,"potn34",SLOT_MISC16)
    CheckItemSlot(Myself,"potn34",SLOT_MISC17)
    CheckItemSlot(Myself,"potn34",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn34",Myself)  // Potion of Magic Protection
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,24,STR)
  OR(17)
    HasItemEquiped("potn07",Myself)  // Potion of Storm Giant Strength
    CheckItemSlot(Myself,"potn07",SLOT_MISC3)
    CheckItemSlot(Myself,"potn07",SLOT_MISC4)
    CheckItemSlot(Myself,"potn07",SLOT_MISC5)
    CheckItemSlot(Myself,"potn07",SLOT_MISC6)
    CheckItemSlot(Myself,"potn07",SLOT_MISC7)
    CheckItemSlot(Myself,"potn07",SLOT_MISC8)
    CheckItemSlot(Myself,"potn07",SLOT_MISC9)
    CheckItemSlot(Myself,"potn07",SLOT_MISC10)
    CheckItemSlot(Myself,"potn07",SLOT_MISC11)
    CheckItemSlot(Myself,"potn07",SLOT_MISC12)
    CheckItemSlot(Myself,"potn07",SLOT_MISC13)
    CheckItemSlot(Myself,"potn07",SLOT_MISC14)
    CheckItemSlot(Myself,"potn07",SLOT_MISC15)
    CheckItemSlot(Myself,"potn07",SLOT_MISC16)
    CheckItemSlot(Myself,"potn07",SLOT_MISC17)
    CheckItemSlot(Myself,"potn07",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn07",Myself)  // Potion of Storm Giant Strength
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,23,STR)
  OR(17)
    HasItemEquiped("potn06",Myself)  // Potion of Cloud Giant Strength
    CheckItemSlot(Myself,"potn06",SLOT_MISC3)
    CheckItemSlot(Myself,"potn06",SLOT_MISC4)
    CheckItemSlot(Myself,"potn06",SLOT_MISC5)
    CheckItemSlot(Myself,"potn06",SLOT_MISC6)
    CheckItemSlot(Myself,"potn06",SLOT_MISC7)
    CheckItemSlot(Myself,"potn06",SLOT_MISC8)
    CheckItemSlot(Myself,"potn06",SLOT_MISC9)
    CheckItemSlot(Myself,"potn06",SLOT_MISC10)
    CheckItemSlot(Myself,"potn06",SLOT_MISC11)
    CheckItemSlot(Myself,"potn06",SLOT_MISC12)
    CheckItemSlot(Myself,"potn06",SLOT_MISC13)
    CheckItemSlot(Myself,"potn06",SLOT_MISC14)
    CheckItemSlot(Myself,"potn06",SLOT_MISC15)
    CheckItemSlot(Myself,"potn06",SLOT_MISC16)
    CheckItemSlot(Myself,"potn06",SLOT_MISC17)
    CheckItemSlot(Myself,"potn06",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn06",Myself)  // Potion of Cloud Giant Strength
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,22,STR)
  OR(17)
    HasItemEquiped("potn05",Myself)  // Potion of Fire Giant Strength
    CheckItemSlot(Myself,"potn05",SLOT_MISC3)
    CheckItemSlot(Myself,"potn05",SLOT_MISC4)
    CheckItemSlot(Myself,"potn05",SLOT_MISC5)
    CheckItemSlot(Myself,"potn05",SLOT_MISC6)
    CheckItemSlot(Myself,"potn05",SLOT_MISC7)
    CheckItemSlot(Myself,"potn05",SLOT_MISC8)
    CheckItemSlot(Myself,"potn05",SLOT_MISC9)
    CheckItemSlot(Myself,"potn05",SLOT_MISC10)
    CheckItemSlot(Myself,"potn05",SLOT_MISC11)
    CheckItemSlot(Myself,"potn05",SLOT_MISC12)
    CheckItemSlot(Myself,"potn05",SLOT_MISC13)
    CheckItemSlot(Myself,"potn05",SLOT_MISC14)
    CheckItemSlot(Myself,"potn05",SLOT_MISC15)
    CheckItemSlot(Myself,"potn05",SLOT_MISC16)
    CheckItemSlot(Myself,"potn05",SLOT_MISC17)
    CheckItemSlot(Myself,"potn05",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn05",Myself)  // Potion of Fire Giant Strength
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,21,STR)
  OR(17)
    HasItemEquiped("potn04",Myself)  // Potion of Frost Giant Strength
    CheckItemSlot(Myself,"potn04",SLOT_MISC3)
    CheckItemSlot(Myself,"potn04",SLOT_MISC4)
    CheckItemSlot(Myself,"potn04",SLOT_MISC5)
    CheckItemSlot(Myself,"potn04",SLOT_MISC6)
    CheckItemSlot(Myself,"potn04",SLOT_MISC7)
    CheckItemSlot(Myself,"potn04",SLOT_MISC8)
    CheckItemSlot(Myself,"potn04",SLOT_MISC9)
    CheckItemSlot(Myself,"potn04",SLOT_MISC10)
    CheckItemSlot(Myself,"potn04",SLOT_MISC11)
    CheckItemSlot(Myself,"potn04",SLOT_MISC12)
    CheckItemSlot(Myself,"potn04",SLOT_MISC13)
    CheckItemSlot(Myself,"potn04",SLOT_MISC14)
    CheckItemSlot(Myself,"potn04",SLOT_MISC15)
    CheckItemSlot(Myself,"potn04",SLOT_MISC16)
    CheckItemSlot(Myself,"potn04",SLOT_MISC17)
    CheckItemSlot(Myself,"potn04",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn04",Myself)  // Potion of Frost Giant Strength
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,20,STR)
  OR(17)
    HasItemEquiped("potn12",Myself)  // Potion of Stone Giant Strength
    CheckItemSlot(Myself,"potn12",SLOT_MISC3)
    CheckItemSlot(Myself,"potn12",SLOT_MISC4)
    CheckItemSlot(Myself,"potn12",SLOT_MISC5)
    CheckItemSlot(Myself,"potn12",SLOT_MISC6)
    CheckItemSlot(Myself,"potn12",SLOT_MISC7)
    CheckItemSlot(Myself,"potn12",SLOT_MISC8)
    CheckItemSlot(Myself,"potn12",SLOT_MISC9)
    CheckItemSlot(Myself,"potn12",SLOT_MISC10)
    CheckItemSlot(Myself,"potn12",SLOT_MISC11)
    CheckItemSlot(Myself,"potn12",SLOT_MISC12)
    CheckItemSlot(Myself,"potn12",SLOT_MISC13)
    CheckItemSlot(Myself,"potn12",SLOT_MISC14)
    CheckItemSlot(Myself,"potn12",SLOT_MISC15)
    CheckItemSlot(Myself,"potn12",SLOT_MISC16)
    CheckItemSlot(Myself,"potn12",SLOT_MISC17)
    CheckItemSlot(Myself,"potn12",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn12",Myself)  // Potion of Stone Giant Strength
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,19,STR)
  OR(17)
    HasItemEquiped("potn03",Myself)  // Potion of Hill Giant Strength
    CheckItemSlot(Myself,"potn03",SLOT_MISC3)
    CheckItemSlot(Myself,"potn03",SLOT_MISC4)
    CheckItemSlot(Myself,"potn03",SLOT_MISC5)
    CheckItemSlot(Myself,"potn03",SLOT_MISC6)
    CheckItemSlot(Myself,"potn03",SLOT_MISC7)
    CheckItemSlot(Myself,"potn03",SLOT_MISC8)
    CheckItemSlot(Myself,"potn03",SLOT_MISC9)
    CheckItemSlot(Myself,"potn03",SLOT_MISC10)
    CheckItemSlot(Myself,"potn03",SLOT_MISC11)
    CheckItemSlot(Myself,"potn03",SLOT_MISC12)
    CheckItemSlot(Myself,"potn03",SLOT_MISC13)
    CheckItemSlot(Myself,"potn03",SLOT_MISC14)
    CheckItemSlot(Myself,"potn03",SLOT_MISC15)
    CheckItemSlot(Myself,"potn03",SLOT_MISC16)
    CheckItemSlot(Myself,"potn03",SLOT_MISC17)
    CheckItemSlot(Myself,"potn03",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn03",Myself)  // Potion of Hill Giant Strength
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatLT(Myself,15,STR)
  OR(17)
    HasItemEquiped("potn44",Myself)  // Potion of Strength
    CheckItemSlot(Myself,"potn44",SLOT_MISC3)
    CheckItemSlot(Myself,"potn44",SLOT_MISC4)
    CheckItemSlot(Myself,"potn44",SLOT_MISC5)
    CheckItemSlot(Myself,"potn44",SLOT_MISC6)
    CheckItemSlot(Myself,"potn44",SLOT_MISC7)
    CheckItemSlot(Myself,"potn44",SLOT_MISC8)
    CheckItemSlot(Myself,"potn44",SLOT_MISC9)
    CheckItemSlot(Myself,"potn44",SLOT_MISC10)
    CheckItemSlot(Myself,"potn44",SLOT_MISC11)
    CheckItemSlot(Myself,"potn44",SLOT_MISC12)
    CheckItemSlot(Myself,"potn44",SLOT_MISC13)
    CheckItemSlot(Myself,"potn44",SLOT_MISC14)
    CheckItemSlot(Myself,"potn44",SLOT_MISC15)
    CheckItemSlot(Myself,"potn44",SLOT_MISC16)
    CheckItemSlot(Myself,"potn44",SLOT_MISC17)
    CheckItemSlot(Myself,"potn44",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn44",Myself)  // Potion of Strength
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatGT(Myself,0,ARMORCLASS)
  OR(17)
    HasItemEquiped("potn24",Myself)  // Potion of Defense
    CheckItemSlot(Myself,"potn24",SLOT_MISC3)
    CheckItemSlot(Myself,"potn24",SLOT_MISC4)
    CheckItemSlot(Myself,"potn24",SLOT_MISC5)
    CheckItemSlot(Myself,"potn24",SLOT_MISC6)
    CheckItemSlot(Myself,"potn24",SLOT_MISC7)
    CheckItemSlot(Myself,"potn24",SLOT_MISC8)
    CheckItemSlot(Myself,"potn24",SLOT_MISC9)
    CheckItemSlot(Myself,"potn24",SLOT_MISC10)
    CheckItemSlot(Myself,"potn24",SLOT_MISC11)
    CheckItemSlot(Myself,"potn24",SLOT_MISC12)
    CheckItemSlot(Myself,"potn24",SLOT_MISC13)
    CheckItemSlot(Myself,"potn24",SLOT_MISC14)
    CheckItemSlot(Myself,"potn24",SLOT_MISC15)
    CheckItemSlot(Myself,"potn24",SLOT_MISC16)
    CheckItemSlot(Myself,"potn24",SLOT_MISC17)
    CheckItemSlot(Myself,"potn24",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn24",Myself)  // Potion of Defense
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  CheckStatGT(Myself,0,ARMORCLASS)
  OR(17)
    HasItemEquiped("potn11",Myself)  // Potion of Invulnerability
    CheckItemSlot(Myself,"potn11",SLOT_MISC3)
    CheckItemSlot(Myself,"potn11",SLOT_MISC4)
    CheckItemSlot(Myself,"potn11",SLOT_MISC5)
    CheckItemSlot(Myself,"potn11",SLOT_MISC6)
    CheckItemSlot(Myself,"potn11",SLOT_MISC7)
    CheckItemSlot(Myself,"potn11",SLOT_MISC8)
    CheckItemSlot(Myself,"potn11",SLOT_MISC9)
    CheckItemSlot(Myself,"potn11",SLOT_MISC10)
    CheckItemSlot(Myself,"potn11",SLOT_MISC11)
    CheckItemSlot(Myself,"potn11",SLOT_MISC12)
    CheckItemSlot(Myself,"potn11",SLOT_MISC13)
    CheckItemSlot(Myself,"potn11",SLOT_MISC14)
    CheckItemSlot(Myself,"potn11",SLOT_MISC15)
    CheckItemSlot(Myself,"potn11",SLOT_MISC16)
    CheckItemSlot(Myself,"potn11",SLOT_MISC17)
    CheckItemSlot(Myself,"potn11",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn11",Myself)  // Potion of Invulnerability
    DisplayStringHead(Myself,@5005)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  !CheckSpellState(Myself,POTION_OF_CLARITY)
  !CheckSpellState(Myself,CHAOTIC_COMMANDS)
  !CheckSpellState(Myself,MIND_BLANK)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  OR(17)
    HasItemEquiped("potn21",Myself)  // Potion of Clarity
    CheckItemSlot(Myself,"potn21",SLOT_MISC3)
    CheckItemSlot(Myself,"potn21",SLOT_MISC4)
    CheckItemSlot(Myself,"potn21",SLOT_MISC5)
    CheckItemSlot(Myself,"potn21",SLOT_MISC6)
    CheckItemSlot(Myself,"potn21",SLOT_MISC7)
    CheckItemSlot(Myself,"potn21",SLOT_MISC8)
    CheckItemSlot(Myself,"potn21",SLOT_MISC9)
    CheckItemSlot(Myself,"potn21",SLOT_MISC10)
    CheckItemSlot(Myself,"potn21",SLOT_MISC11)
    CheckItemSlot(Myself,"potn21",SLOT_MISC12)
    CheckItemSlot(Myself,"potn21",SLOT_MISC13)
    CheckItemSlot(Myself,"potn21",SLOT_MISC14)
    CheckItemSlot(Myself,"potn21",SLOT_MISC15)
    CheckItemSlot(Myself,"potn21",SLOT_MISC16)
    CheckItemSlot(Myself,"potn21",SLOT_MISC17)
    CheckItemSlot(Myself,"potn21",SLOT_MISC18)
THEN
  RESPONSE #100
    UseItem("potn21",Myself)  // Potion of Clarity
    DisplayStringHead(Myself,@5005)
END


////////////////////////////////////////////////////
// 4 Hours
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  HasItemEquiped("OHRCLCK4",Myself)  // Cloak of the Dark Moon
  GlobalLT("MO_UsedClkDrkMN","GLOBAL",3)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  Global("MO_CastAthkatla","LOCALS",1)
THEN
  RESPONSE #100
    UseItem("OHRCLCK4",Myself)  // Cloak of the Dark Moon
    IncrementGlobal("MO_UsedClkDrkMN","GLOBAL",1)
END

// Use Broken Glasses of Hope for its Infravision ability

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  AreaType(32) // dungen
  Race(Myself,HUMAN)
  !StateCheck(Myself,STATE_INFRAVISION)
  OR(17)
    HasItemEquiped("L#RVGLA",Myself) // Broken Glasses of Hope
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC3)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC4)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC5)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC6)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC7)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC8)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC9)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC10)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC11)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC12)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC13)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC14)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC15)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC16)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC17)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC18)
  GlobalLT("MO_UsedBrokenGlasses","GLOBAL",3)
THEN
  RESPONSE #100
    UseItemAbility("L#RVGLA",Myself,SLOT_AMMO3,0)
    IncrementGlobal("MO_UsedBrokenGlasses","GLOBAL",1)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  AreaType(1) // outdoor
  TimeOfDay(2) // night
  Race(Myself,HUMAN)
  !StateCheck(Myself,STATE_INFRAVISION)
  OR(17)
    HasItemEquiped("L#RVGLA",Myself) // Broken Glasses of Hope
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC3)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC4)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC5)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC6)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC7)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC8)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC9)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC10)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC11)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC12)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC13)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC14)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC15)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC16)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC17)
    CheckItemSlot(Myself,"L#RVGLA",SLOT_MISC18)
  GlobalLT("MO_UsedBrokenGlasses","GLOBAL",3)
THEN
  RESPONSE #100
    UseItemAbility("L#RVGLA",Myself,SLOT_AMMO3,0)
    IncrementGlobal("MO_UsedBrokenGlasses","GLOBAL",1)
END


////////////////////////////////////////////////////
// 2 Hours
// 5e Spellcasting Prebuff Spirit Armor
/*
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_SPIRIT_ARMOR)  // SPWI414.SPL (Spirit Armor)
  !CheckSpellState(Myself,MAGE_ARMOR)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_SPIRIT_ARMOR)  // SPWI414.SPL (Spirit Armor)
    RemoveSpell(WIZARD_SPIRIT_ARMOR)  // SPWI414.SPL (Spirit Armor)
END
*/
////////////////////////////////////////////////////
// 1 Hour
// 5e Spellcasting Prebuff Ghost Armor
/*
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_GHOST_ARMOR)  // SPWI317.SPL (Ghost Armor)
  !CheckSpellState(Myself,MAGE_ARMOR)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_GHOST_ARMOR)  // SPWI317.SPL (Ghost Armor)
    RemoveSpell(WIZARD_GHOST_ARMOR)  // SPWI317.SPL (Ghost Armor)
END
*/
////////////////////////////////////////////////////
// 9 Hours
// 5e Spellcasting Prebuff Mage Armor
/*
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_ARMOR)  // SPWI102.SPL (Armor)
  !CheckSpellState(Myself,MAGE_ARMOR)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_ARMOR)  // SPWI102.SPL (Armor)
    RemoveSpell(WIZARD_ARMOR)  // SPWI102.SPL (Armor)
END
*/
////////////////////////////////////////////////////
// 1 Hour
// 5e Spellcasting Prebuff Mage Shield

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_SHIELD)  // SPWI114.SPL (Shield)
  // IWD Shield Ring
  !CheckSpellState(Myself,WIZARD_SHIELD)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_SHIELD)  // SPWI114.SPL (Shield)
    RemoveSpell(WIZARD_SHIELD)  // SPWI114.SPL (Shield)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
  !Class(Myself,SORCERER)
  !CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_PETRIFICATION)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
    RemoveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
  !Class(Myself,SORCERER)
  !CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_PETRIFICATION)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
    RemoveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
  !Class(Myself,SORCERER)
  !CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_PETRIFICATION)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
    RemoveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
  !Class(Myself,SORCERER)
  !CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_PETRIFICATION)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
    RemoveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
  !Class(Myself,SORCERER)
  !CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_PETRIFICATION)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
    RemoveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
  !Class(Myself,SORCERER)
  !CheckSpellState(LastSeenBy(Myself),PROTECTION_FROM_PETRIFICATION)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
    RemoveSpell(WIZARD_PROTECTION_FROM_PETRIFICATION)  // SPWI108.SPL (Protection from Petrification)
END

// 5e Spellcasting Prebuff Resist Fear

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
  !CheckSpellState(Myself,RESIST_FEAR)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
    RemoveSpell(WIZARD_RESIST_FEAR)  // SPWI210.SPL (Resist Fear)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(CAVALIER_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
  !CheckSpellState(Myself,RESIST_FEAR)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CAVALIER_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
    RemoveSpell(CAVALIER_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
END

// 5e Spellcasting Prebuff Cleric Remove Fear

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
  !CheckSpellState(Myself,RESIST_FEAR)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
    RemoveSpell(CLERIC_REMOVE_FEAR)  // SPPR108.SPL (Remove Fear)
END

// 5e Spellcasting Prebuff - IWD Emotion Courage and Hope

// IWD Emotion Courage and Hope

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpellRES("SPRA303")
  !CheckSpellState(Myself,PROTECTION_FROM_NORMAL_MISSILES)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpellRES("SPRA303",Myself)
    RemoveSpellRES("SPRA303")
END

// 5e Spellcasting Prebuff Prot Normal Missiles

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // SPWI311.SPL (Protection From Normal Missiles)
  !CheckSpellState(Myself,PROTECTION_FROM_NORMAL_MISSILES)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // SPWI311.SPL (Protection From Normal Missiles)
    RemoveSpell(WIZARD_PROTECTION_FROM_NORMAL_MISSILES)  // SPWI311.SPL (Protection From Normal Missiles)
END

////////////////////////////////////////////////////
// 1 Turn/Level
// 5e Spellcasting Prebuff Death Ward

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
  See(Myself)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !HasItemEquiped("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
  !HasItemEquiped("OHBCLCK1",LastSeenBy(Myself)) // Cloak of the Lich
  !HasItemEquiped("AC#WCOIN",LastSeenBy(Myself)) // Holy Coin of Waukeen
  !CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
    RemoveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
  See([PC])
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !HasItemEquiped("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
  !HasItemEquiped("OHBCLCK1",LastSeenBy(Myself)) // Cloak of the Lich
  !HasItemEquiped("AC#WCOIN",LastSeenBy(Myself)) // Holy Coin of Waukeen
  !CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
    RemoveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
  See(SecondNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !HasItemEquiped("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
  !HasItemEquiped("OHBCLCK1",LastSeenBy(Myself)) // Cloak of the Lich
  !HasItemEquiped("AC#WCOIN",LastSeenBy(Myself)) // Holy Coin of Waukeen
  !CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
    RemoveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
  See(ThirdNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !HasItemEquiped("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
  !HasItemEquiped("OHBCLCK1",LastSeenBy(Myself)) // Cloak of the Lich
  !HasItemEquiped("AC#WCOIN",LastSeenBy(Myself)) // Holy Coin of Waukeen
  !CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
    RemoveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
  See(FourthNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !HasItemEquiped("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
  !HasItemEquiped("OHBCLCK1",LastSeenBy(Myself)) // Cloak of the Lich
  !HasItemEquiped("AC#WCOIN",LastSeenBy(Myself)) // Holy Coin of Waukeen
  !CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
    RemoveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
  See(FifthNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !HasItemEquiped("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
  !HasItemEquiped("OHBCLCK1",LastSeenBy(Myself)) // Cloak of the Lich
  !HasItemEquiped("AC#WCOIN",LastSeenBy(Myself)) // Holy Coin of Waukeen
  !CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
    RemoveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
  See(SixthNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !HasItemEquiped("SW1H71",LastSeenBy(Myself)) // Hindo's Doom +4
  !HasItemEquiped("OHBCLCK1",LastSeenBy(Myself)) // Cloak of the Lich
  !HasItemEquiped("AC#WCOIN",LastSeenBy(Myself)) // Holy Coin of Waukeen
  !CheckSpellState(LastSeenBy(Myself),DEATH_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
    RemoveSpell(CLERIC_DEATH_WARD)  // SPPR409.SPL (Death Ward)
END

// 5e Spellcasting Prebuff Prot Evil 10'

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
  CheckStat(Myself,0,PROTECTION_FROM_EVIL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
    RemoveSpell(CLERIC_PROTECTION_FROM_EVIL_10_FOOT)  // SPPR408.SPL (Protection From Evil, 10' Radius)
END

// Static Charge
/*
// CheckSpellState is not working for this spell. Because the spell lacks opcode 328 Set Spell State

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(CLERIC_STATIC_CHARGE)  // SPPR419.SPL (Static Charge)
  !CheckSpellState(Myself,STATIC_CHARGE)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_STATIC_CHARGE)  // SPPR419.SPL (Static Charge)
    RemoveSpell(CLERIC_STATIC_CHARGE)  // SPPR419.SPL (Static Charge)
END
*/
// 5e Spellcasting Prebuff Chaotic Commands

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
  See(Myself)
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),MIND_BLANK)
  !CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
    RemoveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
  See([PC])
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),MIND_BLANK)
  !CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  // Major Globe
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
    RemoveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
  See(SecondNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),MIND_BLANK)
  !CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  // Major Globe
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
    RemoveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
  See(ThirdNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),MIND_BLANK)
  !CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  // Major Globe
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
    RemoveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
  See(FourthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),MIND_BLANK)
  !CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  // Major Globe
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
    RemoveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
  See(FifthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),MIND_BLANK)
  !CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  // Major Globe
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
    RemoveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
  See(SixthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),BARBARIAN_RAGE)
  !CheckSpellState(LastSeenBy(Myself),BERSERKER_RAGE)
  !CheckSpellState(LastSeenBy(Myself),CHAOTIC_COMMANDS)
  !CheckSpellState(LastSeenBy(Myself),MIND_BLANK)
  !CheckSpellState(LastSeenBy(Myself),POTION_OF_CLARITY)
  !HasItemEquiped("SHLD25",LastSeenBy(Myself)) // Shield of Harmony
  !HasItemEquiped("O#CRAMUL",LastSeenBy(Myself)) // Amulet of Harmony
  !HasItemEquiped("mh#ring5",LastSeenBy(Myself)) // Ring of Mind Shielding
  !HasItemEquiped("MOAM07",LastSeenBy(Myself)) // Amulet of Protected Dalliances
  !HasItemEquiped("NWCLCKAC",LastSeenBy(Myself)) // Improved Nymph Cloak
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  // Major Globe
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
    RemoveSpell(CLERIC_CHAOTIC_COMMANDS)  // SPPR508.SPL (Chaotic Commands)
END

// 5e Spellcasting Prebuff - MiH Foresight

// MiH Foresight

// 5e Spellcasting Prebuff Prot Magic Energy

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
  CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
  CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
  CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
  CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
  CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
  CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SixthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
  CheckStatLT(LastSeenBy(Myself),50,MAGICDAMAGERESISTANCE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_PROTECTION_FROM_MAGIC_ENERGY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_MAGIC_ENERGY)  // SPWI606.SPL (Protection From Magic Energy)
END

// 5e Spellcasting Prebuff - MiH Cleric Celestial Protection

// MiH Cleric Celestial Protection

// 5e Spellcasting Prebuff - MiH Circle of Protection

// MiH Circle of Protection

// 5e Spellcasting Prebuff Prot from Electricity

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
    RemoveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  // Major Globe
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
    RemoveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  // Major Globe
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
    RemoveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  // Major Globe
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
    RemoveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  // Major Globe
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
    RemoveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  // Major Globe
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
    RemoveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SixthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  // Major Globe
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
    RemoveSpell(WIZARD_PROTECTION_FROM_ELECTRICITY)  // SPWI512.SPL (Protection From Electricity)
END

// Cleric Protection from Electricity



// 5e Spellcasting Prebuff Prot from Fire

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
    RemoveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
    RemoveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
    RemoveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
    RemoveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
    RemoveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
    RemoveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SixthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
    RemoveSpell(WIZARD_PROTECTION_FROM_FIRE)  // SPWI319.SPL (Protection From Fire)
END

// Cleric Protection from Fire

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SixthNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

// 5e Spellcasting Prebuff Prot from Cold

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
  CheckStatLT(LastSeenBy(Myself),20,RESISTCOLD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
    RemoveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
  CheckStatLT(LastSeenBy(Myself),20,RESISTCOLD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
    RemoveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
  CheckStatLT(LastSeenBy(Myself),20,RESISTCOLD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
    RemoveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
  CheckStatLT(LastSeenBy(Myself),20,RESISTCOLD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
    RemoveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
  CheckStatLT(LastSeenBy(Myself),20,RESISTCOLD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
    RemoveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
  CheckStatLT(LastSeenBy(Myself),20,RESISTCOLD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
    RemoveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SixthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
  CheckStatLT(LastSeenBy(Myself),20,RESISTCOLD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
    RemoveSpell(WIZARD_PROTECTION_FROM_COLD)  // SPWI320.SPL (Protection From Cold)
END

// 5e Spellcasting Prebuff Prot from Acid

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
  CheckStatLT(LastSeenBy(Myself),20,RESISTACID)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
    RemoveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
  CheckStatLT(LastSeenBy(Myself),20,RESISTACID)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
    RemoveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
  CheckStatLT(LastSeenBy(Myself),20,RESISTACID)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
    RemoveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
  CheckStatLT(LastSeenBy(Myself),20,RESISTACID)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
    RemoveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
  CheckStatLT(LastSeenBy(Myself),20,RESISTACID)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
    RemoveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
  CheckStatLT(LastSeenBy(Myself),20,RESISTACID)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
    RemoveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
END

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SixthNearest([PC]))
  HaveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
  CheckStatLT(LastSeenBy(Myself),20,RESISTACID)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
    RemoveSpell(WIZARD_PROTECTION_FROM_ACID)  // SPWI517.SPL (Protection From Acid)
END

////////////////////////////////////////////////////
// 5 Turns
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  !CheckSpellState(Myself,RESIST_FEAR)
  HaveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
    RemoveSpell(INVOKE_COURAGE)  // SPIN676.SPL (Invoke Courage)
END

// Skills and Abilities Prebuff Protective Field

////////////////////////////////////////////////////
// 3 Turns
IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
  HaveSpell(MAZZY_STRENGTH)  // SPIN826.SPL (Strength)
  CheckStatLT(Myself,18,STR)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,MAZZY_STRENGTH)  // SPIN826.SPL (Strength)
    RemoveSpell(MAZZY_STRENGTH)  // SPIN826.SPL (Strength)
END

////////////////////////////////////////////////////
// 3 Rounds/Level
// 5e Spellcasting Prebuff Prot from Evil

IF
  Global("MO_BUFF","LOCALS",1)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
  See(Myself)
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
    RemoveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
  See([PC])
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
    RemoveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
  See(SecondNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
    RemoveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
  See(ThirdNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
    RemoveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
  See(FourthNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
    RemoveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
  See(FifthNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
    RemoveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
  See(SixthNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
    RemoveSpell(CLERIC_PROTECT_FROM_EVIL)  // SPPR107.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See(Myself)
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

////////////////////////////////////////////////////
// 5 Rounds/Level
// 5e Spellcasting Prebuff Prot from Lightning

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
  See(Myself)
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
    RemoveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
  See([PC])
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
    RemoveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
  See(SecondNearest([PC]))
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
    RemoveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
  See(ThirdNearest([PC]))
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
    RemoveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
  See(FourthNearest([PC]))
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
    RemoveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
  See(FifthNearest([PC]))
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
    RemoveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
  See(SixthNearest([PC]))
  CheckStatLT(LastSeenBy(Myself),20,RESISTELECTRICITY)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
    RemoveSpell(CLERIC_PROTECTION_FROM_LIGHTNING)  // SPPR407.SPL (Protection From Lightning)
END

////////////////////////////////////////////////////
// 3 Rounds/Level
// 5e Spellcasting Prebuff Spirit Ward

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
  See(Myself)
  !CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
    RemoveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
  See([PC])
  !CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
    RemoveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
  See(SecondNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
    RemoveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
  See(ThirdNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
    RemoveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
  See(FourthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
    RemoveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
  See(FifthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
    RemoveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
  See(SixthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),SPIRIT_WARD)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
    RemoveSpell(CLERIC_SPIRIT_WARD)  // SPPR150.SPL (Spirit Ward)
END

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpellRES("SPRA302")
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpellRES("SPRA302",Myself)
    RemoveSpellRES("SPRA302")
END

////////////////////////////////////////////////////
// 4 Rounds + 2 Rounds/Level
// 5e Spellcasting Prebuff Blur

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_BLUR)  // SPWI201.SPL (Blur)
  // IWD Shimmering Sash
  !StateCheck(Myself,STATE_BLUR)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_BLUR)  // SPWI201.SPL (Blur)
    RemoveSpell(WIZARD_BLUR)  // SPWI201.SPL (Blur)
END

IF
  Global("MO_BUFF","LOCALS",1)
  !StateCheck(Myself,STATE_BLUR)
  // IWD Shimmering Sash
  HaveSpellRES("SPDM102")  // Blur
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpellRES("SPDM102",Myself)  // Blur
    RemoveSpellRES("SPDM102")  // Blur
END

////////////////////////////////////////////////////
// 3 Rounds + 1 Round/Level
// 5e Spellcasting Prebuff - MiH Wizard Barrier

// Prebuff - MiH Wizard Barrier

// 5e Spellcasting Prebuff Haste

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_HASTE)  // SPWI305.SPL (Haste)
  !StateCheck(Myself,STATE_HASTED)
  !CheckSpellState(Myself,IMPROVED_HASTE)
  !StateCheck(Myself,STATE_NOT_TARGETABLE)
  !CheckStat(Myself,8,WIZARD_SPELL_IMMUNITY)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  !CheckStatGT(Myself,0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,MINOR_GLOBE)
  !CheckSpellState(Myself,GLOBE)
  !CheckSpellState(Myself,MINOR_SPELL_TURNING)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(Myself,1,WIZARD_SPELL_TRAP)
  !CheckStat(Myself,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_HASTE)  // SPWI305.SPL (Haste)
    RemoveSpell(WIZARD_HASTE)  // SPWI305.SPL (Haste)
END

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpellRES("SPRA301")  // Stalker Haste
  !StateCheck(Myself,STATE_HASTED)
  !CheckSpellState(Myself,IMPROVED_HASTE)
  !StateCheck(Myself,STATE_NOT_TARGETABLE)
  !CheckStat(Myself,8,WIZARD_SPELL_IMMUNITY)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  !CheckStatGT(Myself,0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(Myself,MINOR_GLOBE)
  !CheckSpellState(Myself,GLOBE)
  !CheckSpellState(Myself,MINOR_SPELL_TURNING)
  !CheckSpellState(Myself,SPELL_TURNING)
  !CheckStat(Myself,1,WIZARD_SPELL_TRAP)
  !CheckStat(Myself,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpellRES("SPRA301",Myself)  // Stalker Haste
    RemoveSpellRES("SPRA301")  // Stalker Haste
END

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(MAZZY_HASTE)  // SPIN828.SPL (Haste)
  !StateCheck(Myself,STATE_HASTED)
  !CheckSpellState(Myself,IMPROVED_HASTE)
  !StateCheck(Myself,STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,MAZZY_HASTE)  // SPIN828.SPL (Haste)
    RemoveSpell(MAZZY_HASTE)  // SPIN828.SPL (Haste)
END

// 5e Spellcasting Prebuff Armor of Faith

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
  !CheckSpellState(Myself,ARMOR_OF_FAITH)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
    RemoveSpell(CLERIC_ARMOR_OF_FAITH)  // SPPR111.SPL (Armor of Faith)
END

// 5e Spellcasting Prebuff Mirror Image

IF
  Global("MO_BUFF","LOCALS",1)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  HaveSpell(WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStat(Myself,1,PUPPETTYPE)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
    RemoveSpell(WIZARD_MIRROR_IMAGE)  // SPWI212.SPL (Mirror Image)
END

IF
  Global("MO_BUFF","LOCALS",1)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  HaveSpellRES("SPDM106")  // Mirror Image
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpellRES("SPDM106",Myself)  // Mirror Image
    RemoveSpellRES("SPDM106")  // Mirror Image
END

// 5e Spellcasting Prebuff Fire Shield Red

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fire Shield (Red))
  !CheckSpellState(Myself,RED_FIRESHIELD)
  !CheckSpellState(Myself,BLUE_FIRESHIELD)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fire Shield (Red))
    RemoveSpell(WIZARD_FIRE_SHIELD_RED)  // SPWI418.SPL (Fire Shield (Red))
END

// 5e Spellcasting Prebuff Fire Shield Blue

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_FIRE_SHIELD_BLUE)  // SPWI403.SPL (Fire Shield (Blue))
  !CheckSpellState(Myself,RED_FIRESHIELD)
  !CheckSpellState(Myself,BLUE_FIRESHIELD)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_FIRE_SHIELD_BLUE)  // SPWI403.SPL (Fire Shield (Blue))
    RemoveSpell(WIZARD_FIRE_SHIELD_BLUE)  // SPWI403.SPL (Fire Shield (Blue))
END

// 5e Spellcasting Prebuff Cleric Prot from Fire
/*
IF
  Global("MO_BUFF","LOCALS",1)
  See(Myself)
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See([PC])
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SecondNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),100,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(ThirdNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FourthNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(FifthNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  See(SixthNearest([PC]))
  HaveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
  CheckStatLT(LastSeenBy(Myself),20,RESISTFIRE)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
    RemoveSpell(CLERIC_PROTECTION_FROM_FIRE)  // SPPR306.SPL (Protection From Fire)
END
*/
// 5e Spellcasting Prebuff - MiH Resist Acid/Corrosion

// MiH Resist Acid/Corrosion

// 5e Spellcasting Prebuff - MiH Protect Cold

// MiH Protect Cold

// 5e Spellcasting Prebuff Improved Haste

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
  See(Myself)
  !CheckSpellState(LastSeenBy(Myself),IMPROVED_HASTE)
  OR(2)
    CheckStatGT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
    StateCheck(LastSeenBy(Myself),STATE_HASTED)
  !CheckStatLT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),6,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),7,NUMBEROFATTACKS)
  !Class(LastSeenBy(Myself),MONK)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
    RemoveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
  See([PC])
  !CheckSpellState(LastSeenBy(Myself),IMPROVED_HASTE)
  OR(2)
    CheckStatGT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
    StateCheck(LastSeenBy(Myself),STATE_HASTED)
  !CheckStatLT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),6,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),7,NUMBEROFATTACKS)
  CheckSpellState(LastSeenBy(Myself),NEED_IMPROVED_HASTE)
  !Class(LastSeenBy(Myself),MONK)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_TRANSMUTATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
    RemoveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
  See(SecondNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),IMPROVED_HASTE)
  OR(2)
    CheckStatGT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
    StateCheck(LastSeenBy(Myself),STATE_HASTED)
  !CheckStatLT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),6,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),7,NUMBEROFATTACKS)
  CheckSpellState(LastSeenBy(Myself),NEED_IMPROVED_HASTE)
  !Class(LastSeenBy(Myself),MONK)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_TRANSMUTATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
    RemoveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
  See(ThirdNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),IMPROVED_HASTE)
  OR(2)
    CheckStatGT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
    StateCheck(LastSeenBy(Myself),STATE_HASTED)
  !CheckStatLT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),6,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),7,NUMBEROFATTACKS)
  CheckSpellState(LastSeenBy(Myself),NEED_IMPROVED_HASTE)
  !Class(LastSeenBy(Myself),MONK)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_TRANSMUTATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
    RemoveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
  See(FourthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),IMPROVED_HASTE)
  OR(2)
    CheckStatGT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
    StateCheck(LastSeenBy(Myself),STATE_HASTED)
  !CheckStatLT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),6,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),7,NUMBEROFATTACKS)
  CheckSpellState(LastSeenBy(Myself),NEED_IMPROVED_HASTE)
  !Class(LastSeenBy(Myself),MONK)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_TRANSMUTATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
    RemoveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
  See(FifthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),IMPROVED_HASTE)
  OR(2)
    CheckStatGT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
    StateCheck(LastSeenBy(Myself),STATE_HASTED)
  !CheckStatLT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),6,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),7,NUMBEROFATTACKS)
  CheckSpellState(LastSeenBy(Myself),NEED_IMPROVED_HASTE)
  !Class(LastSeenBy(Myself),MONK)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_TRANSMUTATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
    RemoveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
  See(SixthNearest([PC]))
  !CheckSpellState(LastSeenBy(Myself),IMPROVED_HASTE)
  OR(2)
    CheckStatGT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
    StateCheck(LastSeenBy(Myself),STATE_HASTED)
  !CheckStatLT(LastSeenBy(Myself),2,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),6,NUMBEROFATTACKS)
  !CheckStat(LastSeenBy(Myself),7,NUMBEROFATTACKS)
  CheckSpellState(LastSeenBy(Myself),NEED_IMPROVED_HASTE)
  !Class(LastSeenBy(Myself),MONK)
  // Major Globe
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_TRANSMUTATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
    RemoveSpell(WIZARD_IMPROVED_HASTE)  // SPWI613.SPL (Improved Haste)
END

// FP Cleric Divine Improved Haste

// 5e Spellcasting Prebuff - MiH Cleric Striking

// MiH Cleric Striking

// 5e Spellcasting Prebuff Magic Resistance

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_MAGIC_RESISTANCE)  // SPPR509.SPL (Magic Resistance)
  CheckStatLT(Myself,20,RESISTMAGIC)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_MAGIC_RESISTANCE)  // SPPR509.SPL (Magic Resistance)
    RemoveSpell(CLERIC_MAGIC_RESISTANCE)  // SPPR509.SPL (Magic Resistance)
END

// FP Cleric Divine Haste

// 5e Spellcasting Prebuff - MiH Wizard Superheroism

// MiH Wizard Superheroism

// 5e Spellcasting Prebuff - MiH Cleric Superheroism

// MiH Cleric Superheroism

// 5e Spellcasting Prebuff - MiH Spell Invulnerability

// MiH Spell Invulnerability

////////////////////////////////////////////////////
// 23 Rounds 
IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  !CheckSpellState(Myself,IMPROVED_HASTE)
  GlobalLT("MO_UsedCheetah","GLOBAL",1)
  HasItemEquiped("AMUL26",Myself)  // Amulet of Cheetah Speed
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItem("AMUL26",Myself)  // Amulet of Cheetah Speed
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedCheetah","GLOBAL",1)
END

////////////////////////////////////////////////////
// 2 Turns
// 5e Spellcasting Prebuff - IWD Seven Eyes

// IWD Seven Eyes

// MiH Prebuff Mirror Amulet

// Barkskin

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_BARKSKIN)  // SPPR202.SPL (Barkskin)
  !CheckSpellState(Myself,BARKSKIN)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_BARKSKIN)  // SPPR202.SPL (Barkskin)
    RemoveSpell(CLERIC_BARKSKIN)  // SPPR202.SPL (Barkskin)
END


////////////////////////////////////////////////////
// 1 Round + 1 Round/Level
// 5e Spellcasting Prebuff Aid

IF
  Global("MO_BUFF","LOCALS",1)
  GlobalLT("BDAI_ATTACK_MODE","LOCALS",2) // Solo + Group buff
  HaveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)
  See(Myself)
  !StateCheck(LastSeenBy(Myself),STATE_AID)
  OR(4)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),THIEF_ALL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_AID)  // SPPR201.SPL (Aid)
    RemoveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2) // Group buff
  HaveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)  
  See([PC])
  !StateCheck(LastSeenBy(Myself),STATE_AID)
  OR(10)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),SWASHBUCKLER)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
    Kit(LastSeenBy(Myself),BLACKGUARD)
    Kit(LastSeenBy(Myself),DWARVEN_DEFENDER)
    Kit(LastSeenBy(Myself),BARBARIAN)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_AID)  // SPPR201.SPL (Aid)
    RemoveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2) // Group buff
  HaveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)  
  See(SecondNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_AID)
  OR(10)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),SWASHBUCKLER)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
    Kit(LastSeenBy(Myself),BLACKGUARD)
    Kit(LastSeenBy(Myself),DWARVEN_DEFENDER)
    Kit(LastSeenBy(Myself),BARBARIAN)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(),CLERIC_AID)  // SPPR201.SPL (Aid)
    RemoveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2) // Group buff
  HaveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)  
  See(ThirdNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_AID)
  OR(10)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),SWASHBUCKLER)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
    Kit(LastSeenBy(Myself),BLACKGUARD)
    Kit(LastSeenBy(Myself),DWARVEN_DEFENDER)
    Kit(LastSeenBy(Myself),BARBARIAN)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(),CLERIC_AID)  // SPPR201.SPL (Aid)
    RemoveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2) // Group buff
  HaveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)  
  See(FourthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_AID)
  OR(10)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),SWASHBUCKLER)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
    Kit(LastSeenBy(Myself),BLACKGUARD)
    Kit(LastSeenBy(Myself),DWARVEN_DEFENDER)
    Kit(LastSeenBy(Myself),BARBARIAN)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(),CLERIC_AID)  // SPPR201.SPL (Aid)
    RemoveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2) // Group buff
  HaveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)  
  See(FifthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_AID)
  OR(10)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),SWASHBUCKLER)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
    Kit(LastSeenBy(Myself),BLACKGUARD)
    Kit(LastSeenBy(Myself),DWARVEN_DEFENDER)
    Kit(LastSeenBy(Myself),BARBARIAN)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_NECROMANCY)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(),CLERIC_AID)  // SPPR201.SPL (Aid)
    RemoveSpell(CLERIC_AID)  // SPPR201.SPL (Aid)
END

////////////////////////////////////////////////////
// 1 Round/Level
// 5e Spellcasting Prebuff Prot from Energy

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_PROTECTION_FROM_ENERGY)  // SPWI803.SPL (Protection From Energy)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_ENERGY)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_THE_ELEMENTS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_PROTECTION_FROM_ENERGY)  // SPWI803.SPL (Protection From Energy)
    RemoveSpell(WIZARD_PROTECTION_FROM_ENERGY)  // SPWI803.SPL (Protection From Energy)
END

// 5e Spellcasting Prebuff Prot from the Elements

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_PROTECTION_FROM_THE_ELEMENTS)  // SPWI702.SPL (Protection From The Elements)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_ENERGY)
  !CheckStatGT(Myself,0,WIZARD_PROTECTION_FROM_THE_ELEMENTS)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_PROTECTION_FROM_THE_ELEMENTS)  // SPWI702.SPL (Protection From The Elements)
    RemoveSpell(WIZARD_PROTECTION_FROM_THE_ELEMENTS)  // SPWI702.SPL (Protection From The Elements)
END

// 5e Spellcasting Prebuff - MiH Wizard Heroism

// MiH Wizard Heroism

// 5e Spellcasting Prebuff - MiH Cleric Heroism

// MiH Cleric Heroism

// 5e Spellcasting Prebuff - MiH Cleric Aura of Vitality

// MiH Cleric Aura of Vitality

// 5e Spellcasting Prebuff - MiH Wizard Seeking

// MiH Wizard Seeking

// 5e Spellcasting Prebuff - MiH Cleric Seeking

// MiH Cleric Seeking

// 5e Spellcasting Prebuff - IWD Prayer, Restoration, and Entropy Shield

// Entropy Shield

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_ENTROPY_SHIELD)  // SPPR616.SPL (Entropy Shield)
  !CheckSpellState(Myself,ENTROPY_SHIELD)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_ENTROPY_SHIELD)  // SPPR616.SPL (Entropy Shield)
    RemoveSpell(CLERIC_ENTROPY_SHIELD)  // SPPR616.SPL (Entropy Shield)
END

// IWD Prayer, Recitation
/*
IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_PRAYER)  // SPPR320.SPL (Prayer)
  !ExtendedStateCheck(Myself,STATE_PRAYER)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_PRAYER)  // SPPR320.SPL (Prayer)
    RemoveSpell(CLERIC_PRAYER)  // SPPR320.SPL (Prayer)
END

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_RECITATION)  // SPPR420.SPL (Recitation)
  !ExtendedStateCheck(Myself,STATE_RECITATION)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_RECITATION)  // SPPR420.SPL (Recitation)
    RemoveSpell(CLERIC_RECITATION)  // SPPR420.SPL (Recitation)
END
*/
// 5e Spellcasting Prebuff Holy Power

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_HOLY_POWER)  // SPPR412.SPL (Holy Power)
  !CheckSpellState(Myself,HOLY_POWER)
  OR(3)
    CheckStatLT(Myself,19,STR)
    HaveSpell(CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
    HaveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_HOLY_POWER)  // SPPR412.SPL (Holy Power)
    RemoveSpell(CLERIC_HOLY_POWER)  // SPPR412.SPL (Holy Power)
END

// 5e Spellcasting Prebuff Righteous Magic

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
  !CheckSpellState(Myself,RIGHTEOUS_MAGIC)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
    RemoveSpell(CLERIC_RIGHTEOUS_MAGIC)  // SPPR513.SPL (Righteous Magic)
END

// Song & Silence Mind Blade

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(LATHANDER_BOON)
  !CheckSpellState(Myself,LATHANDER_BOON)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,LATHANDER_BOON)
    RemoveSpell(LATHANDER_BOON)
END

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(TALOS_STORMSHIELD)
  !CheckSpellState(Myself,STORM_SHELL)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,TALOS_STORMSHIELD)
    RemoveSpell(TALOS_STORMSHIELD)
END

////////////////////////////////////////////////////
// 18 Rounds

// Ring of Duplication - Mirror Image

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  GlobalLT("MO_UsedDuplication","GLOBAL",3)
  OR(17)
    HasItemEquiped("OHRRING1",Myself)  // Ring of Duplication
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC3)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC4)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC5)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC6)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC7)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC8)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC9)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC10)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC11)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC12)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC13)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC14)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC15)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC16)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC17)
    CheckItemSlot(Myself,"OHRRING1",SLOT_MISC18)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItem("OHRRING1",Myself)  // Ring of Duplication
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedDuplication","GLOBAL",1)
END

// 5e Spellcasting Prebuff Black Blade of Disaster

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_BLACK_BLADE_OF_DISASTER)  // SPWI915.SPL (Black Blade of Disaster)
  !CheckSpellState(Myself,BLACK_BLADE)  // Black Blade of Disaster
  !HasItem("melfmet",Myself)  // Melf's Minute Meteor
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_BLACK_BLADE_OF_DISASTER)  // SPWI915.SPL (Black Blade of Disaster)
    RemoveSpell(WIZARD_BLACK_BLADE_OF_DISASTER)  // SPWI915.SPL (Black Blade of Disaster)
END

////////////////////////////////////////////////////
// 1 Round/2 Levels
// 5e Spellcasting Prebuff Aura of Flaming Death

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_AURA_OF_FLAMING_DEATH)  // SPPR730.SPL (Aura of Flaming Death)
  CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
  CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_AURA_OF_FLAMING_DEATH)  // SPPR730.SPL (Aura of Flaming Death)
    RemoveSpell(CLERIC_AURA_OF_FLAMING_DEATH)  // SPPR730.SPL (Aura of Flaming Death)
END

// Skills and Abilities Prebuff Resist Magic

/*
IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WARRIOR_HARDINESS)  // SPCL907.SPL (Hardiness)
  !CheckSpellState(Myself,HARDINESS)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WARRIOR_HARDINESS)  // SPCL907.SPL (Hardiness)
    RemoveSpell(WARRIOR_HARDINESS)  // SPCL907.SPL (Hardiness)
END
*/

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpellRES("SPCL237")  // Greater Sun
  CheckStatLT(Myself,50,RESISTFIRE)
  CheckStatLT(Myself,50,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpellRES("SPCL237",Myself)  // Greater Sun
    RemoveSpellRES("SPCL237")  // Greater Sun
END

////////////////////////////////////////////////////
// 1 Turn

IF
  Global("MO_BUFF","LOCALS",1)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See(Myself)
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See([PC])
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See(SecondNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See(ThirdNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See(FourthNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See(FifthNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  Global("MO_TeamProtEvil","GLOBAL",0)
  HaveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
  See(SixthNearest([PC]))
  CheckStat(LastSeenBy(Myself),0,PROTECTION_FROM_EVIL)
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),MINOR_GLOBE)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
    RemoveSpell(PALADIN_PROTECTION_FROM_EVIL)  // SPCL213.SPL (Protection From Evil)
END

// Rogue's Cowl - Mirror Image + Blur

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  GlobalLT("MO_UsedRogueCowl","GLOBAL",3)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  !StateCheck(Myself,STATE_BLUR)
  OR(17)
    HasItemEquiped("RR#RCOWL",Myself) // Rogue's Cowl
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC3)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC4)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC5)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC6)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC7)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC8)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC9)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC10)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC11)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC12)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC13)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC14)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC15)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC16)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC17)
    CheckItemSlot(Myself,"RR#RCOWL",SLOT_MISC18)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItemAbility("RR#RCOWL",Myself,SLOT_AMMO3,0)  // Rogue's Cowl
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedRogueCowl","GLOBAL",1)
END

// Barrier Amulet - Stoneskin + MGoI

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  GlobalLT("MO_UsedBarrierAmulet","GLOBAL",3)
  CheckStatLT(Myself,1,STONESKINS)
  !CheckSpellState(Myself,MINOR_GLOBE)
  OR(17)
    HasItemEquiped("RR#AMULB",Myself) // Barrier Amulet
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC3)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC4)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC5)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC6)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC7)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC8)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC9)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC10)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC11)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC12)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC13)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC14)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC15)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC16)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC17)
    CheckItemSlot(Myself,"RR#AMULB",SLOT_MISC18)
THEN
  RESPONSE #100
    SetGlobal("MO_TrueSightActive","LOCALS",1)
    SetGlobal("MO_PartyTrueSight","GLOBAL",1)
    SetInterrupt(FALSE)
    UseItemAbility("RR#AMULB",Myself,SLOT_AMMO3,0)  // Barrier Amulet
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedBarrierAmulet","GLOBAL",1)
END

// Ilbratha - Mirror Image

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  !StateCheck(Myself,STATE_MIRRORIMAGE)
  GlobalLT("MO_UsedIlbratha","GLOBAL",1)
  OR(17)
    HasItemEquiped("SW1H26",Myself)  // Ilbratha +1
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC3)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC4)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC5)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC6)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC7)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC8)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC9)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC10)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC11)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC12)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC13)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC14)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC15)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC16)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC17)
    CheckItemSlot(Myself,"SW1H26",SLOT_MISC18)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItemAbility("SW1H26",Myself,SLOT_AMMO3,1)  // Ilbratha +1
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedIlbratha","GLOBAL",1)
END

// Headband of the Devout - Righteous Magic

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  GlobalLT("MO_UsedDevout","GLOBAL",1)
  !CheckSpellState(Myself,RIGHTEOUS_MAGIC)
  OR(17)
    HasItemEquiped("OHRHELM1",Myself)  // Headband of the Devout
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC3)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC4)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC5)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC6)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC7)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC8)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC9)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC10)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC11)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC12)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC13)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC14)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC15)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC16)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC17)
    CheckItemSlot(Myself,"OHRHELM1",SLOT_MISC18)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItem("OHRHELM1",Myself)  // Headband of the Devout
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedDevout","GLOBAL",1)
END

// Robe of the Eyes - True Sight

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_SPECIAL","LOCALS",0)
  Global("MO_UsedRobeEye","GLOBAL",0)
  OR(17)
    HasItemEquiped("AC#WROEY",Myself) // Robe of the Eyes
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC3)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC4)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC5)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC6)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC7)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC8)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC9)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC10)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC11)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC12)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC13)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC14)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC15)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC16)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC17)
    CheckItemSlot(Myself,"AC#WROEY",SLOT_MISC18)
  Global("MO_PartyTrueSight","GLOBAL",0)
  Global("MO_DetectEnemyIllusion","GLOBAL",0)
THEN
  RESPONSE #100
    SetGlobal("MO_TrueSightActive","LOCALS",1)
    SetGlobal("MO_PartyTrueSight","GLOBAL",1)
    SetInterrupt(FALSE)
    UseItemAbility("AC#WROEY",Myself,SLOT_AMMO3,0)  // Robe of the Eyes
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedRobeEye","GLOBAL",1)
END

// 5e Spellcasting Prebuff Globe of Blades

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_GLOBE_OF_BLADES)  // SPPR725.SPL (Globe of Blades)
  CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
  CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_GLOBE_OF_BLADES)  // SPPR725.SPL (Globe of Blades)
    RemoveSpell(CLERIC_GLOBE_OF_BLADES)  // SPPR725.SPL (Globe of Blades)
END

// 5e Spellcasting Prebuff Blade Barrier

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_BLADE_BARRIER)  // SPPR603.SPL (Blade Barrier)
  CheckStat(Myself,0,WIZARD_FIRE_SHIELD)
  CheckStatLT(Myself,1,CLERIC_BLADE_BARRIER)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_BLADE_BARRIER)  // SPPR603.SPL (Blade Barrier)
    RemoveSpell(CLERIC_BLADE_BARRIER)  // SPPR603.SPL (Blade Barrier)
END

// 5e Spellcasting Prebuff - DSotSC Selunes Blessing and Aura of Protection

// DSotSC Selunes Blessing and Aura of Protection

// 5e Spellcasting Prebuff Chant

/*
IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_CHANT)  // SPPR203.SPL (Chant)
  !StateCheck(Myself,STATE_CHANT)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_CHANT)  // SPPR203.SPL (Chant)
    RemoveSpell(CLERIC_CHANT)  // SPPR203.SPL (Chant)
END
*/

// DSotSC Wizard Army of One

// 5e Spellcasting Prebuff Draw Upon Holy Might

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
  !StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
  CheckStatLT(Myself,25,STR)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
    RemoveSpell(CLERIC_DRAW_UPON_HOLY_MIGHT)  // SPPR214.SPL (Draw Upon Holy Might)
END

// Cast from DUHM scroll

IF
  Global("MO_BUFF","LOCALS",1)
  HasItemEquiped("CDID214",Myself)  // Draw Upon Holy Might
  !StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
  CheckStatLT(Myself,25,STR)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    UseItem("CDID214",Myself)  // Draw Upon Holy Might
END

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpellRES("SPIN103")  // Divine Might
  !StateCheck(Myself,STATE_DRAWUPONHOLYMIGHT)
  CheckStatLT(Myself,25,STR)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
THEN
  RESPONSE #100
    ReallyForceSpellRES("SPIN103",Myself)  // Divine Might
    RemoveSpellRES("SPIN103")  // Divine Might
END

// FP Cleric Divine Aura, Warding Winds, and EPIC Divine Might

// 5e Spellcasting Prebuff - MiH Cleric Mass Negative Plane Protection

// MiH Cleric Mass Negative Plane Protection

////////////////////////////////////////////////////
// 9 Rounds
// 5e Spellcasting Prebuff Physical Mirror

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_PHYSICAL_MIRROR)  // sppr525.spl (Physical Mirror)
  CheckStatLT(Myself,1,CLERIC_PHYSICAL_MIRROR)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_PHYSICAL_MIRROR)  // sppr525.spl (Physical Mirror)
    RemoveSpell(CLERIC_PHYSICAL_MIRROR)  // sppr525.spl (Physical Mirror)
END

////////////////////////////////////////////////////
// 6 Rounds
// 5e Spellcasting Prebuff Bless

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_BLESS)  // SPPR101.SPL (Bless)
  !StateCheck(Myself,STATE_BLESS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_BLESS)  // SPPR101.SPL (Bless)
    RemoveSpell(CLERIC_BLESS)  // SPPR101.SPL (Bless)
    Wait(1)
END

// 5e Spellcasting Prebuff Defensive Harmony

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  CheckStat(Myself,0,CLERIC_DEFENSIVE_HARMONY)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
    RemoveSpell(CLERIC_DEFENSIVE_HARMONY)  // SPPR406.SPL (Defensive Harmony)
END

////////////////////////////////////////////////////
// 5 Rounds
// 5e Spellcasting Prebuff Negative Plane Protection

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
  See(Myself)
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
  !CheckStatGT(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
  !HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
  !HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
    RemoveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
  See([PC])
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
  !CheckStatGT(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
  !HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
  !HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
    RemoveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
  See(SecondNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
  !CheckStatGT(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
  !HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
  !HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
    RemoveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
  See(ThirdNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
  !CheckStatGT(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
  !HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
  !HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
    RemoveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
  See(FourthNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
  !CheckStatGT(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
  !HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
  !HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
    RemoveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
  See(FifthNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
  !CheckStatGT(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
  !HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
  !HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
    RemoveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
  See(SixthNearest([PC]))
  !Kit(LastSeenBy(Myself),UNDEADHUNTER)
  !CheckSpellState(LastSeenBy(Myself),LATHANDER_BOON)
  !CheckStatGT(LastSeenBy(Myself),0,LEVEL_DRAIN_IMMUNITY)
  !HasItemEquiped("AMUL21",LastSeenBy(Myself))  // Amulet of Power
  !HasItemEquipedReal("BLUN25",LastSeenBy(Myself))  // Mace of Disruption +2
  !HasItemEquipedReal("SW1H69",LastSeenBy(Myself))  // Spectral Brand +5
  !StateCheck(LastSeenBy(Myself),STATE_IMPROVEDINVISIBILITY)
  !CheckSpellState(LastSeenBy(Myself),SI_ABJURATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),GLOBE)
  !CheckSpellState(LastSeenBy(Myself),MINOR_SPELL_TURNING)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
    RemoveSpell(CLERIC_NEGATIVE_PLANE_PROTECTION)  // SPPR413.SPL (Negative Plane Protection)
END

// Cleric Regeneration
/*
IF
  Global("MO_BUFF","LOCALS",1)
  //CheckStat(Myself,1,SANCTUARY)
  HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
  See(Myself)
  OR(6)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
  !CheckSpellState(LastSeenBy(Myself),CLERIC_REGENERATION)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
    RemoveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //CheckStat(Myself,1,SANCTUARY)
  HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
  See([PC])
  OR(6)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
  !CheckSpellState(LastSeenBy(Myself),CLERIC_REGENERATION)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
    RemoveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //CheckStat(Myself,1,SANCTUARY)
  HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
  See(SecondNearest([PC]))
  OR(6)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
  !CheckSpellState(LastSeenBy(Myself),CLERIC_REGENERATION)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
    RemoveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //CheckStat(Myself,1,SANCTUARY)
  HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
  See(ThirdNearest([PC]))
  OR(6)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
  !CheckSpellState(LastSeenBy(Myself),CLERIC_REGENERATION)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
    RemoveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //CheckStat(Myself,1,SANCTUARY)
  HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
  See(FourthNearest([PC]))
  OR(6)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
  !CheckSpellState(LastSeenBy(Myself),CLERIC_REGENERATION)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
    RemoveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //CheckStat(Myself,1,SANCTUARY)
  HaveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
  See(FifthNearest([PC]))
  OR(6)
    Class(LastSeenBy(Myself),FIGHTER_ALL)
    Class(LastSeenBy(Myself),RANGER_ALL)
    Class(LastSeenBy(Myself),PALADIN_ALL)
    Class(LastSeenBy(Myself),MONK)
    Kit(LastSeenBy(Myself),BLADE)
    Kit(LastSeenBy(Myself),SKALD)
  !CheckSpellState(LastSeenBy(Myself),CLERIC_REGENERATION)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_TARGETABLE)
  !StateCheck(LastSeenBy(Myself),STATE_NOT_APPROACHABLE)
  !CheckStatGT(LastSeenBy(Myself),0,WIZARD_SPELL_DEFLECTION)
  !CheckSpellState(LastSeenBy(Myself),SPELL_TURNING)
  !CheckStat(LastSeenBy(Myself),1,WIZARD_SPELL_TRAP)
  !CheckStat(LastSeenBy(Myself),1,CLERIC_SHIELD_OF_THE_ARCHONS)
  !CheckStat(LastSeenBy(Myself),7,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
    RemoveSpell(CLERIC_REGENERATE)  // SPPR711.SPL (Regeneration)
END
*/
////////////////////////////////////////////////////
// 3 Rounds/Level
// 5e Spellcasting Prebuff Shield of the Archons or Fiendish Warding

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
  CheckStatLT(Myself,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
    RemoveSpell(CLERIC_SHIELD_OF_THE_ARCHONS)  // SPPR701.SPL (Shield of the Archons)
END

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(CLERIC_FIENDISH_WARDING)  // SPPR742.SPL (Fiendish Warding)
  CheckStatLT(Myself,1,CLERIC_SHIELD_OF_THE_ARCHONS)
  CheckStatLT(Myself,20,SPELLFAILUREPRIEST)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,CLERIC_FIENDISH_WARDING)  // SPPR742.SPL (Fiendish Warding)
    RemoveSpell(CLERIC_FIENDISH_WARDING)  // SPPR742.SPL (Fiendish Warding)
END

// 5e Spellcasting Prebuff Spell Shield

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
  !CheckSpellState(Myself,SPELL_SHIELD)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
    RemoveSpell(WIZARD_SPELL_SHIELD)  // SPWI519.SPL (Spell Shield)
END

// 5e Spellcasting Prebuff Spell Turning

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_SPELL_TURNING)  // SPWI701.SPL (Spell Turning)
  !CheckSpellState(Myself,SPELL_TURNING)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_SPELL_TURNING)  // SPWI701.SPL (Spell Turning)
    RemoveSpell(WIZARD_SPELL_TURNING)  // SPWI701.SPL (Spell Turning)
END

////////////////////////////////////////////////////
// 45 Rounds
IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  HasItemEquiped("OHNSHLD1",Myself)  // Shield of Fyrus Khal +2
  GlobalLT("MO_UsedShldFyrus","GLOBAL",1)
  !CheckSpellState(Myself,SPELL_TURNING)
  Global("MO_CastAthkatla","LOCALS",1)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItem("OHNSHLD1",Myself)  // Shield of Fyrus Khal +2
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedShldFyrus","GLOBAL",1)
END

////////////////////////////////////////////////////
// 15 Rounds

// Ring of Spell Turning

IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  GlobalLT("MO_UsedSpellTurning","GLOBAL",1)
  !CheckSpellState(Myself,SPELL_TURNING)
  OR(17)
    HasItemEquiped("RING34",Myself)  // Ring of Spell Turning
    CheckItemSlot(Myself,"RING34",SLOT_MISC3)
    CheckItemSlot(Myself,"RING34",SLOT_MISC4)
    CheckItemSlot(Myself,"RING34",SLOT_MISC5)
    CheckItemSlot(Myself,"RING34",SLOT_MISC6)
    CheckItemSlot(Myself,"RING34",SLOT_MISC7)
    CheckItemSlot(Myself,"RING34",SLOT_MISC8)
    CheckItemSlot(Myself,"RING34",SLOT_MISC9)
    CheckItemSlot(Myself,"RING34",SLOT_MISC10)
    CheckItemSlot(Myself,"RING34",SLOT_MISC11)
    CheckItemSlot(Myself,"RING34",SLOT_MISC12)
    CheckItemSlot(Myself,"RING34",SLOT_MISC13)
    CheckItemSlot(Myself,"RING34",SLOT_MISC14)
    CheckItemSlot(Myself,"RING34",SLOT_MISC15)
    CheckItemSlot(Myself,"RING34",SLOT_MISC16)
    CheckItemSlot(Myself,"RING34",SLOT_MISC17)
    CheckItemSlot(Myself,"RING34",SLOT_MISC18)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItem("RING34",Myself)  // Ring of Spell Turning
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedSpellTurning","GLOBAL",1)
END

////////////////////////////////////////////////////
// 3 Rounds/Level
// 5e Spellcasting Prebuff Minor Spell Turning

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_MINOR_SPELL_TURNING)  // SPWI522.SPL (Minor Spell Turning)
  !CheckSpellState(Myself,MINOR_SPELL_TURNING)
  !CheckSpellState(Myself,SPELL_TURNING)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_MINOR_SPELL_TURNING)  // SPWI522.SPL (Minor Spell Turning)
    RemoveSpell(WIZARD_MINOR_SPELL_TURNING)  // SPWI522.SPL (Minor Spell Turning)
END

// 5e Spellcasting Prebuff Spell Deflection

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_SPELL_DEFLECTION)  // SPWI618.SPL (Spell Deflection)
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_SPELL_DEFLECTION)  // SPWI618.SPL (Spell Deflection)
    RemoveSpell(WIZARD_SPELL_DEFLECTION)  // SPWI618.SPL (Spell Deflection)
END

// 5e Spellcasting Prebuff Minor Spell Deflection

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
  CheckStatLT(Myself,1,WIZARD_SPELL_DEFLECTION)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
    RemoveSpell(WIZARD_MINOR_SPELL_DEFLECTION)  // SPWI318.SPL (Minor Spell Deflection)
END

// 5e Spellcasting Prebuff - FP Ranger Minor Spell Deflection

// FP Ranger Minor Spell Deflection

// FP Cleric Minor Spell Deflection

////////////////////////////////////////////////////
// 1 Round/Level
// 5e Spellcasting Prebuff - MiH Major Globe Prebuff

// MiH Major Globe Prebuff

// 5e Spellcasting Prebuff Globe of Invulnerability

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_GLOBE_OF_INVULNERABILITY)  // SPWI602.SPL (Globe of Invulnerability)
  !CheckSpellState(Myself,MINOR_GLOBE)
  !CheckSpellState(Myself,GLOBE)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_GLOBE_OF_INVULNERABILITY)  // SPWI602.SPL (Globe of Invulnerability)
    RemoveSpell(WIZARD_GLOBE_OF_INVULNERABILITY)  // SPWI602.SPL (Globe of Invulnerability)
END

// 5e Spellcasting Prebuff Minor Globe of Invulnerability

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_MINOR_GLOBE_OF_INVULNERABILITY)  // SPWI406.SPL (Minor Globe of Invulnerability)
  !CheckSpellState(Myself,MINOR_GLOBE)
  !CheckSpellState(Myself,GLOBE)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_MINOR_GLOBE_OF_INVULNERABILITY)  // SPWI406.SPL (Minor Globe of Invulnerability)
    RemoveSpell(WIZARD_MINOR_GLOBE_OF_INVULNERABILITY)  // SPWI406.SPL (Minor Globe of Invulnerability)
END

////////////////////////////////////////////////////
// 2 Turns
IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  GlobalLT("MO_UsedBltMnrInv","GLOBAL",1)
  HasItemEquiped("OHRBELT2",Myself)  // Belt of Minor Invulnerability
  !CheckSpellState(Myself,MINOR_GLOBE)
  !CheckSpellState(Myself,GLOBE)
  Global("MO_CastAthkatla","LOCALS",1)
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItem("OHRBELT2",Myself)  // Belt of Minor Invulnerability
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedBltMnrInv","GLOBAL",1)
END

// Morpheus562's Kitpack Prebuff Shock Weapon

////////////////////////////////////////////////////
// 1 Round/Level
// 5e Spellcasting Prebuff Spell Immunity

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_SPELL_IMMUNITY)  // SPWI510.SPL (Spell Immunity)
  !CheckStat(Myself,1,WIZARD_SPELL_IMMUNITY)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_SPELL_IMMUNITY_ABJURATION)  // SPWI590.SPL (Immunity: Abjuration)
    RemoveSpell(WIZARD_SPELL_IMMUNITY)  // SPWI510.SPL (Spell Immunity)
END

////////////////////////////////////////////////////
// 18 Rounds
// 5e Spellcasting Prebuff Spell Trap

IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
  CheckStatLT(Myself,1,WIZARD_SPELL_TRAP)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(Myself,WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
    RemoveSpell(WIZARD_SPELL_TRAP)  // SPWI902.SPL (Spell Trap)
END

////////////////////////////////////////////////////
// 1 Turn
IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
  !CheckSpellState(Myself,BERSERKER_RAGE_FATIGUE)
  !CheckSpellState(Myself,BERSERKER_RAGE)
THEN
  RESPONSE #100
    Spell(Myself,BERSERKER_RAGE)  // SPCL321.SPL (Enrage)
END

// Morpheus562 Kitpack Prebuff Reckless Abandon

// Skills and Abilities Prebuff War Cry

////////////////////////////////////////////////////
// 5 Rounds
IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
  !CheckSpellState(Myself,BARBARIAN_RAGE)
THEN
  RESPONSE #100
    Spell(Myself,BARBARIAN_RAGE)  // SPCL152.SPL (Barbarian Rage)
END

// FP Kit Rage

// FP Kit Paladin Rage/Frenzy

////////////////////////////////////////////////////
// 20 Seconds (3.3 Rounds) 
IF
  Global("MO_BUFF","LOCALS",1)
  Global("BDAI_DISABLE_ITEMS","LOCALS",0)
  !CheckSpellState(Myself,IMPROVED_HASTE)
  GlobalLT("MO_UsedBlindingSpeed","GLOBAL",1)
  HasItemEquiped("BRAC16",Myself)  // Bracers of Blinding Strike
THEN
  RESPONSE #100
    SetInterrupt(FALSE)
    UseItem("BRAC16",Myself)  // Bracers of Blinding Strike
    SetInterrupt(TRUE)
    IncrementGlobal("MO_UsedBlindingSpeed","GLOBAL",1)
END

////////////////////////////////////////////////////
// 3 Rounds
// 5e Spellcasting Prebuff Luck
IF
  Global("MO_BUFF","LOCALS",1)
  HaveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
  See(Myself)
  !StateCheck(LastSeenBy(Myself),STATE_LUCK)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_LUCK)  // SPWI209.SPL (Luck)
    RemoveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
  See([PC])
  !StateCheck(LastSeenBy(Myself),STATE_LUCK)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_LUCK)  // SPWI209.SPL (Luck)
    RemoveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
  See(SecondNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_LUCK)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_LUCK)  // SPWI209.SPL (Luck)
    RemoveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
  See(ThirdNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_LUCK)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_LUCK)  // SPWI209.SPL (Luck)
    RemoveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
  See(FourthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_LUCK)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_LUCK)  // SPWI209.SPL (Luck)
    RemoveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
END

IF
  Global("MO_BUFF","LOCALS",1)
  //Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
  See(FifthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_LUCK)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_LUCK)  // SPWI209.SPL (Luck)
    RemoveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
END

IF
  Global("MO_BUFF","LOCALS",1)
 // Global("BDAI_ATTACK_MODE","LOCALS",2)
  HaveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
  See(SixthNearest([PC]))
  !StateCheck(LastSeenBy(Myself),STATE_LUCK)
  !CheckSpellState(LastSeenBy(Myself),SI_ENCHANTMENT)
  CheckStatLT(Myself,20,SPELLFAILUREMAGE)
  !CheckStatGT(Myself,0,CLERIC_INSECT_PLAGUE)
  !StateCheck(Myself,STATE_POISONED)
  !StateCheck(Myself,STATE_SILENCED)
  Global("MO_CastAthkatla","LOCALS",1)
  !CheckSpellState(Myself,WILD_MAGIC_AREA)
  !CheckSpellState(Myself,DEAD_MAGIC_AREA)
THEN
  RESPONSE #100
    ReallyForceSpell(LastSeenBy(Myself),WIZARD_LUCK)  // SPWI209.SPL (Luck)
    RemoveSpell(WIZARD_LUCK)  // SPWI209.SPL (Luck)
END

// 5e Spellcasting Prebuff Ending

IF
  OR(2)
    Global("MO_BUFF","LOCALS",1)
    Global("MO_LONG_BUFF","LOCALS",1)
THEN
  RESPONSE #100
    SetGlobal("MO_BUFF","LOCALS",0)
    SetGlobal("MO_LONG_BUFF","LOCALS",0)
    DisplayStringHead(Myself,@5004)
END
